{
  "id": "chatcmpl-A3UEGJH0RPzmG8JSmSb5lI21QibQe",
  "choices": [
    {
      "finish_reason": "stop",
      "index": 0,
      "logprobs": null,
      "message": {
        "content": "```w9xo | If we look at the Population and Land Data source, we do not see any of the gray chain links next to our dimensions that indicate that the fields are linked. There's a reason behind this. The names of the fields are not exactly the same. In order for Tableau Public to identify the join conditions automatically, the field names need to be exactly the same, with both capitalization, punctuation, and content. The field types need to be exactly the same as well.\nutyz | From the Data menu, we can create a join on Country name in the Floods, as follows:\ntquj | One. Click on Edit Relationships.\noepx | Two. In the Edit Relationships dialog box, which is shown in the following screenshot, ensure that the appropriate data source is selected as the primary data source, which is the data source from which the first field is added to the visualization.\nqt5u | Three. Select the appropriate secondary data source.\na2kn | Four. Click on the Custom radio button in case it is not selected by default. In this case, there are no automatic joins. Therefore, Tableau Public assumes that we need custom joins.\n84li | Five. Click on Add:\noh1c | Next, we need to tell Tableau Public that the Country Name field in the major global floods data, which was created to remediate data quality issues, is the same as the Country field in the major global floods data source, as shown in the following screenshot:\napax | You can create only one custom join at a time. So for instance, if you would like to add more joins, such as a date field, you need to add each one individually by clicking on the OK button and then clicking on the Add button again, which we did in order to add a second join on the year of the event.\nzc7j | Note the small arrow next to the Began field, which is above Country Name. This field allows you to establish a join condition on a specific date part. Since we also wanted to join the data sources on the year of the flood event, we expanded the list to see the appropriate dateparts, clicked on Year, and then selected Year in the secondary data source.\n96pn | We clicked on OK again to return to the visualization, which is still the map that we created that shows the average flooded land.\ntxea | The view is now different. Looking at the Data window for the Population and Land Data source, you will see that that there are two chain links, the chain link for Country, and the following is orange. Because the linking field is a part of the visualization, you will see that Country Name is on the Detail shelf on the Marks card. However, Year has a gray, broken chain link because it is not a part of the visualization. If you want it to be used in the calculated fields, click on the gray chain link to activate the join. Even though the field might not be on the visualization, it still be a part of calculations using fields from its data source, as shown in the following screenshot:\n8oh3 | Chapter Five\nm27u | We can create a calculated field that produces the average amount of land in each country that was flooded. In this case, since some countries might have had major floods that add up to more than one hundred percent of the total flooded land, we will create the maximum percent of land flooded, as shown in the following screenshot:\ns0b6 | In order to create this calculation, perform the following steps:\nihlu | One. Create a new calculated field in the major global floods data source.\nr3zr | ]\nj6ku | Two. Name the field.\nzt0d | Three. Add Affected square kilometers to the numerator by dragging it into the dialog box.\nej0q | Four. Wrap it in a max function.\ndg44 | Five. Add a division sign because we want to divide it by the total area of the country.\nlhtj | Six. Click on the Population and Land Data source and drag Area of Country to the denominator.\nns07 | Seven. The denominator is automatically summed. You can change the sum to whatever aggregation you would like, but if you do not aggregate the fields that are from the secondary data sources, you will get error messages.\nq8bx | Eight. Change the aggregation of the field from the secondary data source, which is the field whose name is preceded by its data source name. This is similar to a SQL query that is used to find out an average. The reason behind why we did this is that for every record in the partition, Tableau Public needs to know what to do with the denominator. If we sum it, we will not have the proper calculation.\nlftq | Check out the correct calculated field, It's important to learn how to handle errors. The next two errors are very common and are as follows:\nhyaf | · The following screenshot shows that we cannot mix aggregate and non-aggregate arguments with this function, with the division function highlighted. This means that in a calculated field, both arguments must be aggregated. We can resolve this by aggregating the numerator or by using the ATTR function on it. ATTR tells Tableau to use the discrete value for it:\n9etn | Chapter Five\n2bic | · All fields must be aggregate or constant when using table calculation functions or fields from multiple data sources. This means that the denominator, which is from a secondary data source, must be aggregated. Tableau Public requires this so that it knows how to aggregate. We resolved this by placing the AVG function around the denominator and adding an aggregation to the denominator:\njras | Summary\ndwvf | In this chapter, we explored the different data types in Tableau Public. You learned how to create various types of calculated fields, which enable you to create new metrics and tell stories that are relevant and impactful to users.\nic87 | In the next chapter, we will build on these capabilities to create Level of Detail calculations and table calculations.\nbxpw | Level of Detail and Table Calculations\n4g09 | In the previous chapter, you learned how to use custom calculations to create new fields that add context and insights to the story that you are telling with Tableau Public. In this chapter, we will discuss how you can use table calculations and level of detail calculations to enhance the comparisons that you are making with the data. We will build on several of the calculations that we have created to show you how to make them more dynamic and contextual.\ntxr8 | The table calculations are different from the traditional calculations because they are performed locally on the data in the cache, that is, the data that Tableau Public has used to create the visualization. Not all data that is in your data set is in use all the time. The data in the cache is what Tableau Public is using in the memory to render your visualization. Therefore, the data that you have filtered out will not be included in the table calculations.\nrsup | Level of detail calculations, which are a new feature in Tableau nine, allow you to tell Tableau Public at exactly which dimensional level you want the calculations to be aggregated. We are discussing them along with table calculations because some of the concepts are very similar.\nhk1c | Table calculations have the following major functions:\nna8b | · Calculating change over time as a relative percentage\na4wk | · Calculating the percentage of a whole attributed to a one-dimensional member\nbi02 | · Calculating change relative to other members of a dimension\nyc23 | · Distinguishing the maximum or minimum values in a partition\nki0m | · Moving calculations, such as averages and sums\n6wrx | Level of Detail and Table Calculations\nu4q7 | · Running calculations, such as running sums, that are used for waterfall and Pareto graphs\njd7m | The following are the level of detail calculations that Tableau Public enables you to do:\nsknv | · Fix the level of aggregation\nusuw | · Include specific dimensions, that may not be present on the visualization, in calculations\nd4hr | · Exclude specific dimensions, that are present on the visualization, from specific calculations\nph8j | In this chapter, we will discuss the following table calculations:\nbemf | · Creating quick table calculations\ns9l9 | · Addressing and partitioning table calculations\nbs07 | · Changing over time\ny6eq | · Editing table calculations\n0tl4 | · Moving averages - window max and running max\nvbq2 | · Ranks and percentiles\n```",
        "role": "assistant",
        "function_call": null,
        "tool_calls": null,
        "refusal": null
      }
    }
  ],
  "created": 1725394548,
  "model": "gpt-4o-2024-05-13",
  "object": "chat.completion",
  "system_fingerprint": "fp_fde2829a40",
  "usage": {
    "completion_tokens": 1754,
    "prompt_tokens": 3449,
    "total_tokens": 5203
  }
}