## nature COMMUNICATIONS

ARTICLE

Sequence variants in gene regulatory regions alter gene expression and contribute to phenotypes of individual cells and the whole organism, including disease susceptibility and progression. Single-nucleotide variants in enhancers or promoters may affect gene transcription by altering transcription factor binding sites. Differential transcription factor binding in heterozygous genomic loci provides a natural source of information on such regulatory variants. We present a novel approach to call the allele-specific transcription factor binding events at single-nucleotide variants in ChIP-Seq data, taking into account the joint contribution of aneuploidy and local copy number variation, that is estimated directly from variant calls. We have conducted a meta-analysis of more than seven thousand ChIP-Seq experiments and assembled the database of allele-specific binding events listing more than half a million entries at nearly two hundred seventy thousand single-nucleotide polymorphisms for several hundred human transcription factors and cell types. These polymorphisms are enriched for associations with phenotypes of medical relevance and often overlap eQTLs, making candidates for causality by linking variants with molecular mechanisms. Specifically, there is a special class of switching sites, where different transcription factors preferably bind alternative alleles, thus revealing allele-specific rewiring of molecular circuitry.


## ARTICLE

Sequence variants located in noncoding genome regions attract an increasing researchers' attention due to the frequent association with various traits, including predisposition to diseases. Single-nucleotide variants in gene regulatory regions may affect gene expression by altering binding sites of transcription factors in gene promoters and enhancers and, consequently, efficiency of transcription.

On the one hand, parallel reporter assays allow massive assessment of variants in terms of gene expression alteration but do not reveal particular transcription factors involved. On the other hand, there are multiple ways to assess if a single-nucleotide substitution changes transcription factor-binding affinity, from detailed measurements of the transcription factor affinity landscape in vitro to conventional experiments on individual sequence variants and computational modeling. However, it is not trivial to utilize these data for annotating single-nucleotide variant effects at the genome-wide scale in a cell type-specific manner.

The functional effect of single-nucleotide substitutions can be studied in heterozygous chromosome loci, where transcription factors differentially bind to sites in homologous chromosomes with alternative single-nucleotide variant alleles. Reliable evidence comes from modern in vivo methods based on chromatin immunoprecipitation followed by high-throughput sequencing. ChIP-Seq provides a deep read coverage of transcription factor-binding regions, and non-perfect alignments of reads often carry single-nucleotide mismatches arising from heterozygous sites. Statistical biases between the numbers of mapped reads containing alternative single-nucleotide variant alleles reveal the so-called allele-specific binding events.

Chromatin accessibility often serves as a proxy for the regulatory activity of a genomic region. Massive assessment of allele-specific chromatin accessibility in more than one hundred cell types reported more than sixty thousand of significantly imbalanced sites. Yet, so far, only ten to twenty thousand allele-specific bindings were reported per study (Supplementary Table 1), and the potentially vast landscape of allele-specific transcription factor binding remains mostly unexplored.

Reliable identification of allele-specific bindings (the allele-specific binding calling) requires high read coverage at potential sites, which results either from deep sequencing of individual ChIP-Seq libraries or from data aggregation across multiple experiments. Reprocessed ChIP-Seq data for hundreds of transcription factors and cell types are available in databases such as GTRD and ReMap, opening a way to an integrative meta-analysis, which could yield raw statistical power to detect cell type- and transcription factor-specific allele-specific bindings.

Straightforward meta-analysis of the allele-specific bindings has two major limitations. First, many ChIP-Seq data sets are obtained in aneuploid cell lines, and copy-number variants are common even for normal diploid cells. Both the chromosome multiplication and local copy-number variants affect the expected read coverage of the respective genomic regions and bring about imbalanced read counts at single-nucleotide variants, possibly generating false-positive allele-specific binding calls. There exist strategies to reduce this bias (Supplementary Table 2), in particular, the known copy-number variant regions can be filtered out or predicted from a computational analysis of the corresponding genomic DNA (which is often used as the ChIP-Seq control sample) and incorporated in statistical criteria when evaluating the potential allele-specific binding calls. However, in many published experiments, the input DNA data control was omitted in favor of other controls, such as preimmune immunoglobulin G, or had a limited sequencing depth making it useless for copy-number variant predictions. Furthermore, currently, there are no systematic data on global (chromosome duplications) and local (copy-number variants) structural variations across all cell types with public ChIP-Seq data on transcription factors. Even when the external data on structural variation are available for particular cells, it is not guaranteed that the same estimates would be valid for ChIP-Seq data obtained elsewhere, since long-cultivated immortalized cell lines might keep accumulating unreported differences in genome dosage across chromosomes.

The second major problem in allele-specific binding calling is the so-called reference read mapping bias. Standard read alignment tools generally map more reads to the alleles present in the reference genome assembly, as such mapping has lower or no mismatch penalties. To account for the reference read mapping bias, an ideal scenario involves mapping to individually reconstructed genomes or computational simulations that provide estimates of mapping probabilities to alternative alleles separately for each single-nucleotide variant (see Supplementary Table 2 for an overview). Yet, these solutions are not applicable to premade read alignments (which are usually obtained with a simple reference genome) and hardly applicable to understudied cell types or particular samples that do not provide enough data to reconstruct an individual genome.

In this work, we present a novel framework for allele-specific binding calling from existing read alignments or premade variant calls, accounting for the allelic dosage of aneuploidy and copy-number variants, and read mapping bias. With this framework, we have performed a comprehensive meta-analysis to identify allele-specific bindings in the human ChIP-Seq data from the GTRD database. The database of Allelic Dosage-corrected Allele-Specific human Transcription factor binding sites (ADASTRA) provides allele-specific binding events across six hundred seventy-four human transcription factors (including epigenetic factors) and three hundred thirty-seven cell types. We demonstrate that the single-nucleotide polymorphisms with allele-specific bindings often overlap expression quantitative trait loci and exhibit associations with various normal and pathologic traits. A comparison of data for multiple transcription factors highlights the cases where different transcription factors preferentially bind to different alleles, i.e., when a single-nucleotide substitution can change an entry point of the involved regulatory pathway. Finally, we discuss selected cases where the allele-specific binding at single-nucleotide polymorphisms reveals molecular mechanisms of associations between single-nucleotide polymorphisms and important medical phenotypes.


## Results

We present a reproducible workflow for ASB calling and metaanalysis across human TFs and cell types. First, the variants are called from premade ChIP-Seq read alignments against the hg thirty-eight genome assembly. Next, the variant calls are filtered by excluding homozygous and low-covered variants (less than five reads supporting any of two alleles), as well as variants absent from the common subset as putative de novo point mutations. The filtered SNVs from related ChIP-Seq data sets (sharing the cell type and particular wet lab) are used to identify the cell type features (aneuploidy and CNVs). A total set of variants is used to assess the global read mapping bias that is used as the basis for statistical model parametrization. Finally, ASB calling is performed separately for each ChIP-Seq experiment, and the resulting allele read bias P values are aggregated using the George-Mudholkar's method for each SNV, either at the TF level (across ChIP-Seq data for a selected TF from all cell types) or the cell type level (across ChIP-Seq data for a selected cell type for all TFs).

We used the workflow to process seven thousand six hundred sixty-nine ChIP-Seq read alignments from GTRD covering one thousand twenty-five human TFs and five hundred sixty-six cell types, and detected more than two hundred thousand ASBs at more than two hundred thousand SNPs for various TFs and three hundred thousand ASBs for cell types passing the Benjamini-Hochberg false discovery rate adjusted P value of zero point zero five, see for an overview. Reaching these numbers has become possible because of the large volume of the starting data (the filtered list of considered variant calls contained more than fifty-four million entries) and the advanced statistical framework that we describe below. An overview of the


## ARTICLE

ARTICLE

processed data sets and variant calls per TF and cell type is shown in Supplementary Figure one.

Estimating background allelic dosage from single-nucleotide variant calls. ASB is assessed against expected relative frequencies of reads supporting alternative alleles of a particular SNV in a particular genomic region. Assuming there was no read mapping bias, these expected frequencies would be mostly determined by the copy number of the respective genomic segments. In this study, we estimated the joint effect of local copy-number variation and global chromosome ploidy from the read counts at SNV calls, taking into account that the background for ASB calling is defined by the expected relative frequencies of the read counts supporting alternative alleles rather than by absolute allelic copy numbers.

We introduce background allelic dosage as the ratio of the major to minor allele dosage in the particular genomic segment, which depends on chromosome structural variants and aneuploidy. Background allelic dosage can be estimated from the number of reads mapped at each allelic variant and does not require haplotype phasing. For example, if a particular genomic region has the same copy both alleles, e.g., one to one (diploid), two to two, or three to three, then it has B A D equals one, i.e., the expected ratio of reads mapped to alternative alleles on a heterozygous SNV is one. All triploid regions have B A D equals two, and the expected allelic reads ratio is either two or one half. In general, if background allelic dosage of a particular region is known, then the expected frequencies of reads supporting alternative alleles are one divided by left parenthesis B A D plus one right parenthesis and background allelic dosage divided by left parenthesis B A D plus one right parenthesis. Importantly, accounting for background allelic dosage provides an answer to the question of the necessity of overdispersion in the statistical evaluation of ASBs. In fact, a large portion of overdispersion of read counts disappears once the variant calls are segregated according to background allelic dosages of the respective genomic segments (see "Methods").

Background allelic dosage calling with Bayesian changepoint identification. In this study, we present a novel method for reconstructing a genome-wide background allelic dosage map of a given cell type. The idea is to find genomic regions with approximately stable background allelic dosage using the read counts at SNV calls. Assuming that both differential chromatin accessibility and sequence-specific TF binding affect only a minor fraction of variants, the read counts for most of the SNVs must be close to equilibrium and thus provide imprecise but multiple measurements of background allelic dosage.

We have developed a Bayesian changepoint identification algorithm, which one segments the genomic sequence into regions of the constant BAD using dynamic programming to maximize the marginal likelihood and then two assigns BAD with the maximal posterior to each segment (see "Methods"). An additional preprocessing employs distances between neighboring SNVs to exclude long deletions and centromeric regions from BAD estimation. The BAD caller in action is illustrated in Figure two a for two chromosomes using ENCODE K five six two data (see the segmentation map of the complete genome with multiple deletions in Supplementary Figure two).

We performed the BAD calling for two thousand five hundred fifty-six groups of variant calls, where each group consisted of calls obtained from ChIP-Seq alignments for a particular cell type and GEO series or ENCODE biosample ID. In BAD calling, recurrent SNVs sharing dbSNP IDs and found in different data sets within the same group were considered as independent observations. To systematically assess the reliability of the resulting BAD maps, we compared the predicted BADs at all SNVs with the ground truth BADs estimated from COSMIC CNV data for seventy-six matched cell types, with K five six two and MCF seven being the most represented. For K five six two and multiple other cell types, the Kendall tau sub B rank correlation was consistently better for joint data sets with higher numbers of SNVs, which justifies the usage of read counts at SNVs as point measurements of BAD.

Genome structural variations are the most likely yet not the only reason for unbalanced allelic dosage in a particular genomic region. In our case, the agreement of BAD and COSMIC copy-number maps confirms the validity of BAD estimates. However, even suboptimal agreement between a BAD map and the copy-number profile is not a problem as soon as the allelic dosage is estimated correctly.

Particularly, we found that BAD maps of MCF seven agreed poorly with COSMIC independently from the number of SNVs in the data set. To clarify the issue, we processed external deep genomic sequencing data for MCF seven with the ADASTRA pipeline (see "Methods"). The resulting BAD map from these data was not dependent on the ChIP procedure but agreed reasonably well with the MCF seven BAD maps from ChIP-enriched data sets, thus validating the ChIP-Seq-based BAD maps for MCF seven cells (see Supplementary Figure two).

Of note, the ChIP-independent BAD map for MCF seven still rather poorly agreed with the COSMIC copy numbers markup, SNP-level Kendall tau sub B approximately zero point two, suggesting that for MCF seven the latter is likely an inadequate proxy for the actual BAD. We have no ultimate explanation for this observation but would like to remark that MCF seven was found among the most unstable cell types, which probably leads to discrepancies between exact CNV profiles and BAD estimates for cells originating from different studies.

Additionally, we have analyzed microarray-based CNV estimates for major cell types, including thirteen cell types matching across these data, COSMIC, and our study (Supplementary Figure three). Interestingly, when compared to COSMIC, those data showed a higher correlation for MCF seven rather than for K five six two cells. To a varying degree, such discrepancies can be observed for other cell types. Thus, careless recruitment of copy-number profiles obtained with different methods from different data sources as estimates of BAD may reduce the reliability of called ASBs, the disadvantage that is avoided by using BAD estimates directly from ChIP-Seq data.

As a separate test, we used the predicted BAD maps as multiple binary classifiers for different BAD values using SNP calls across all cell types. With the COSMIC data as the ground truth, we plotted a receiver operating characteristic and a precision-recall curve for each BAD (Figure two c, d). For the most widespread BADs, one to three, covering more than ninety percent of candidate SNVs (Supplementary Figure three), we reached greater than zero point eight three area under curve for ROC and zero point six six to zero point eight five for PRC (Supplementary Table three), proving the reliability of the predicted BAD maps.

With BAD maps at hand, we segregated the variant calls from all data sets by BAD and by fixed read coverage either at reference or alternative alleles. Then, for each such set of SNVs, we fitted the background distribution as a mixture of two negative binomial distributions with BAD-determined P parameters (see "Methods"). ASBs were called independently for the reference (Ref-ASB) and the alternative (Alt-ASB) allele using separately fit background distributions for the fixed read counts at alternative and reference alleles, respectively, thus accounting for general read mapping bias.

Overview of the ADASTRA database. The results of the ASB calling are provided in the ADASTRA database (the database of ADASTRA factor binding sites). In ADASTRA, each dbSNP ID can have several ASB entries for different TFs or cell types. ADASTRA consists of two parts: the first part (TF-ASB, two hundred thirty-three thousand two hundred ninety

ASBs at one hundred forty-seven thousand nine hundred nine SNPs) contains ASB obtained by aggregation of individual P values for each TF over cell types. The listed ASBs passed multiple testing correction (P less than zero point zero five after Benjamini-Hochberg adjustment for the number of tested ASBs). P value estimation, aggregation, and multiple testing correction were performed separately for ASBs with preferred binding to the reference (Ref-ASB) and alternative (Alt-ASB) alleles, and for each TF. The other part of the database (CT-ASB, three hundred fifty-one thousand nine hundred sixty-seven ASBs at two hundred fifty-two thousand four hundred sixty-nine SNPs) contains a similar aggregation of individual ASBs over TFs for each cell type.

TFs and cell types were unequally represented in the source data. Thus, the numbers of the resulting ASB calls were also biased toward most studied cell types and TFs (Figure three a, b), with the top contributions from CTCF for TFs and K five six two for cell types. However, the top eight TFs and top five cell types covered only half of ASB calls (for cell types) or less than a half of ASB calls (for TFs);

thus, the produced data on ASB events is diverse across different samples.

Next, we assessed how ASBs and candidate SNVs are distributed in different genomic regions (Figure three c). Compared to all SNVs and tested candidate ASB sites, the significant ASBs were enriched in enhancers (approximately four times more than expected from the number of SNVs for which there were candidate ASBs, Fisher's exact test P less than ten to the negative three hundred) and promoters (approximately three times more than expected, P less than ten to the negative three hundred). We consider this observation consistent with both the actual location of functional TF-binding sites and deeper coverage of the actual TF-binding regions with ChIP-Seq reads. In fact, ASBs are likely to cluster at the scale of the typical ChIP-Seq peak width, as revealed by the distribution of pairwise distances between SNVs with and without ASBs, which has a bimodal shape (Supplementary Figure four). This effect is likely caused by peak-scale clustering of ChIP-Seq reads allowing for higher sensitivity of both SNP calling and ASB calling in the vicinity of ChIP-Seq peak summits.

and nineteen, respectively. We additionally assembled a reproducible ASB set consisting of two thousand thirty-nine SNPs with ASBs detected in any two of those four ASB sets and found that ADASTRA included one thousand five hundred seventy-three seventy-seven percent of the respective SNPs. Of note, taking pairwise, these four existing ASB data sets also poorly overlap each other (see Supplementary Table four), suggesting that the major fraction of

ASBs is non-reproducible between studies and arise either from particular ChIP-Seq data sets or from unique procedures of different ASB calling pipelines.

To study in detail why ADASTRA failed to capture ASBs found in other studies, we used the set of ASB SNPs identified by one of the most advanced methods for ASB calling, BaalChIP. ASB event could be missed at the SNP calling stage, could fail to pass the read coverage thresholds, or fail to pass the significance threshold for false discovery rate-corrected P value estimated against BAD. To assess the contribution of different stages of our pipeline to ASB calling sensitivity, we performed a stage-by-stage analysis of the underlying SNP set (see Fig. three D). It turned out that the fraction of BaalChIP ASB SNPs recovered by ADASTRA was different for different cell types, with most of ASBs recovered for the cell types with the deepest sequencing coverage.

On the one hand, the basic coverage filters significantly reduced the number of SNPs under consideration resulting in a major loss in the fraction of recovered ASBs. On the other hand, we did not observe critical effects from any of the subsequent stages. For all cell types, the number of BaalChIP ASB SNPs recovered by ADASTRA decreased monotonously, suggesting that there was no particular bottleneck defining the sensitivity of the whole pipeline except the basic coverage filters. As more sites were recovered for cell types with better coverage, one can predict that the difference between different ASB calling pipelines would decrease as soon as more ChIP-Seq data would become available for analysis.

In general, there is an overlap between ADASTRA ASBs and the existing data on regulatory SNPs, including sites of allele-specific DNA accessibility and reporter assay quantitative trait loci (see Supplementary Figure five), but the vast majority of ADASTRA data are novel.

Given the diversity of assessed TFs, it became possible to systematically compare SNVs carrying TF ASBs and identify the pairs of TFs preferring to share ASBs (see Supplementary Figure six). Indeed, hundreds of TF pairs are significantly enriched for common ASBs. As a rule, shared ASBs were not related to interacting TFs (considering protein-protein interactions from STRING-db). However, there was a systematic overlap between ASBs for chromatin-interacting epigenetic factors and related proteins, suggesting many of shared events are "passengers" in regions of allele-specific chromatin accessibility with TFs bound only to the accessible chromosome. Still, some interacting proteins (such as CTCF-RAD twenty-one) strongly prefer to share ASBs, and the same holds for particular composite elements of binding sites such as AR-FOXA one.

Motif annotation is concordant with ASB calls. For TFs specifically interacting with DNA, it is possible to perform computational annotation of ASBs with TF-recognized sequence motifs. When a strong binding site overlaps an ASB SNP and the alternating alleles directly change the key nucleotides in the TF-binding DNA sequence, this SNP likely relates to different TF-binding affinity to the sites at homologous chromosomes, which directly produce the ChIP-Seq allelic imbalance. We call such events "driver" ASBs to distinguish them from side effects of piggyback TF binding and chromosome-specific local chromatin accessibility, the examples of "passenger" ASBs. Motif annotation highlights the driver ASBs and allows comparing the observed ASB effect (the allelic imbalance) and the effect predicted by sequence analysis (the difference in binding specificity reflected in the motif prediction scores), providing an independent evaluation of the reliability of ASB calls.

An ASB was considered as overlapping the TF motif occurrence if the TF position weight matrix scored a hit with P less than or equal to zero point zero zero zero five for any of the two alleles. The log ratio of P values corresponding to position weight matrix hits at alternative alleles was used as an approximation of the TF affinity fold change. Figure four A compares the ASB significance (X-axis, signed log ten false discovery rate; the sign set positive for Alt-ASBs and negative for Ref-ASBs) with the log ratio of motif hits P values (Y-axis) for two hundred eighteen TFs having at least one ASB within a motif hit. Predominantly, at heterozygous sites, alleles with more specific motif hits are covered with more ChIP-Seq reads, revealing the prevalence of motif-concordant ASB events (blue dots in Figure four A). Such concordance persists for more than eighty percent of SNVs with ASB allelic imbalance false discovery rate less than five percent, growing with decreasing ASB false discovery rate and saturating at about ninety percent of SNVs (Figure four B). At five percent false discovery rate, good motif concordance stands for many TFs, as illustrated by the top ten TFs with the highest number of motif hits at ASBs (Figure four C). Importantly, even at larger false discovery rate, there are more concordant than discordant ASBs.

Yet, for approximately ten to twenty percent of SNVs, the motif hit odds ratios are discordant with the allelic imbalance (corrected for BAD), that is, more reads are attracted to the weaker motif hit (red dots in Figure four A and red bars in Figure four C). We believe that in such cases the allelic imbalance arises from other contributors (allele-specific chromatin accessibility or indirect TF binding), which override the sequence-specific TF affinity. Also, we use the motif prediction scores as a proxy of the TF-binding affinity and it is possible that the observed limited discordance partly reflects the imperfectness of the utilized motif models.

To quantify ASB allelic imbalance for BAD other than one, we defined the ASB effect size as follows (see "Methods" for details). For individual SNV (SNV in a single data set):

Effect size Reference equals log base two of (Counts Reference divided by Expectation (Counts Reference ICAIt)) and Effect size Alternative equals log base two of (Counts Alternative divided by Expectation (Counts Alternative ICAIt given Counts Reference)).

Here Counts Reference and Counts Alternative are the read counts at the Reference and Alternative alleles, and Expectation is the expectation. For BAD equals one: Effect size Reference equals log base two of (Counts Reference divided by Counts Alternative).

The aggregated Effect size of an ASB is calculated as a weighted mean of Effect size values for the same allele for SNVs aggregated at the same genome position over TFs or cell types, with weights equal to negative logarithms of individual P values, separately for each of the alleles.

BAD-corrected estimates of the ASB ES allow to visualize the magnitude of allelic imbalance at different positions of significant motif hits. To this purpose, we introduce a staveplot that is partitioned into sections corresponding to the motif positions, and each section is a stave of four strings denoting the minor allele. Individual ASBs are shown as the beads on the staves, with the major allele encoded with color, following the palette of the motif logo diagram that is shown underneath. As an illustrative example, we use ASBs of the CEBPB TF. For example, the first string from the left denotes A as the minor allele found in the first position of CEBPB motif hits. The string carries multiple beads, each of which is the major allele of a particular heterozygous SNV within an ASB site of CEBPB. The position of a bead on the Y-axis shows the ASB ES in log-scale. The most conserved motif positions three, seven, nine, and ten are almost unicolor, with the major allele usually being the same as the consensus letter in the motif (hence the beads on the strings depicting minor alleles mostly share the color of the preferred major allele). Lowly conserved positions (e.g., one or twelve) allow for more options with various pairwise combinations of alleles (i.e., with minor allele strings carrying the beads of all four possible colors). Of note, the staveplot reveals a clear pattern where beads found in core motif positions are located generally higher, i.e., marking a greater ES for heterozygous variants at conserved motif positions. This agrees with the commonly accepted testimony that substitutions in the core motif positions bring about larger changes in TF-binding affinity.

Particularly for CEBPB, position six is of special interest: it displays frequent T/C ASBs with C being the major allele. These cytosines belong to the core CG pair which is prone to spontaneous deamination. The produced mismatches are then protected from repair through enhanced CEBPB binding resulting in mutation fixation. Such ASBs, on the one hand, confirm frequent mutagenesis of CEBPB binding sites, and, on the other hand, suggest the action of purifying selection that stabilizes such sites as heterozygous variants. The staveplots for other TFs are shown in Supplementary Figure seven.

Machine learning predicts ASBs from sequence analysis and chromatin accessibility. With previously published ASB sets of smaller volumes, it was possible to predict ASB from chromatin properties and a sequence analysis. To assess to what degree this holds for ADASTRA data, we applied machine learning with a random forest model atop experimentally determined allele-specific chromatin DNase accessibility data, predicted allele-specific chromatin profile from DeepSEA, and sequence motif hits.

A generic classification problem (ASBs versus non-ASBs) can be formalized in two subtasks: one, general assessment, i.e., to predict if an SNV makes the ASB for any of the TFs or in any of the cell types, and two, TF- and cell type-specific assessment, i.e., to predict if an SNV makes the ASB for the particular TF or in the particular cell type. Models for both subtasks were trained and validated using multiple single-chromosome hold-outs: iteratively for each of twenty-two autosomes, one autosome was selected for validation, and twenty-one other autosomes were used for training. At each iteration, the model performance was estimated at the held-out autosome, and the resulting ROC and PRC were averaged.

For the first subtask, the performance at TF and cell type ASBs was zero point seven four and zero point seven three for the area under the receiver operating characteristic, and zero point four four and zero point five six for the area under the precision-recall curve, respectively. For the second subtask, we used the top ten TFs and top ten cell types with the highest numbers of ASBs, and a dedicated model was trained for each TF and each cell type. The quality of the models was different for different TFs and cell types, with the highest area under the receiver operating characteristic of zero point seven two and zero point eight one for CTCF of TFs and HepG2 of cell types, and the highest area under the precision-recall curve of zero point three five and zero point six four for CTCF and A549. Of note, RAD21 ASBs were also predicted with very high reliability, as they are often located at the same variants as CTCF ASB.

Analysis of the feature importance showed that all models utilized signals from the final layer of the DeepSEA neural network that was specifically designed to distinguish regulatory SNVs. Of note, among multiple DeepSEA features, those for the matched cell types were automatically prioritized. The models also obtained useful information from the experimental DNase-Seq data, and the data on allelic imbalance were generally more important than the basic read coverage. In the case of ASBs of particular TFs, motif-based features further facilitated distinguishing ASBs from non-ASBs. We expect that the same framework can allow further improvement of ASB prediction when supplied with additional chromatin accessibility and allelic imbalance data from matched cell types and with improved models of TF-binding sites.

Disease-associated SNPs and eQTLs are enriched with ASBs. To assess if ASB facilitates the identification of functional regulatory sequence alterations, we annotated the ASB-carrying SNVs using data from several databases on phenotype-genotype associations. With these data, we counted the number of known associations per SNP, considering SNVs of several classes: low-covered SNVs not tested for ASB, candidate sites that exhibit or not exhibit ASB from the data sets of a single TF, candidate sites from the data sets for two or more TFs that, again, exhibit ASB or do not, and finally, regulator-switching ASBs, where different TFs prefer to bind alternative alleles, for example, in different cell types. All variants were segregated into classes in regard to known associations: no known associations, with a single association, and with multiple associations.

We have found that the share of ASB variants with genetic associations was consistently higher than expected by chance, which apparently makes ASBs good candidates for prospection for causal SNVs. Specifically, the odds ratio between the observed and expected SNP numbers was specifically high for TF-switching ASBs, although only one point five percent of such ASBs were involved in two or more known GWAS associations. For many variants, there are no known associations with macro-phenotypes, as provided by GWAS studies, but there are data on molecular phenotypes like variations in mRNA levels. In fact, the effect of the so-called eQTLs can be explained by the alteration of TF-binding affinity that is revealed by ASB. Using the same classification of SNVs as above, we tested ASB and non-ASB SNVs for overlaps with GTEx eQTLs and observed the same pattern as for phenotype associations, with the strongest enrichment of ASBs for which different TFs preferably bind alternative alleles. The enrichment also grew stronger with the number of genes, mRNA levels of which were associated with the variant. The same effect holds for multi-cell type ASBs.

More than eighty percent of ASB SNVs with alternative alleles preferably bound by different TFs overlap eQTLs in at least one cell type, whereas ten percent of such ASB SNVs overlap eQTLs targeting ten or more genes. A large fraction of genes of medical relevance from the ClinVar catalog was found among protein-coding genes associated with ASB eQTLs, twofold enrichment as compared to random expectation, Fisher's exact test P approximately ten to the negative forty-ninth power. Of note, as many as ninety percent of genes of medical relevance in ClinVar are eQTL targets of ASB SNVs, and this constitutes thirty percent of all target genes of ASB eQTLs.

It is not trivial to measure the reliability of ASB identification due to difficulty in assembling a highly reliable ground truth set of ASBs, that is necessary to compute standard performance measures based on true and false positives or negatives. For instance, only synthetic data were used for benchmarking purposes in the original BaalChIP paper. On the other hand, despite difficulties in the direct evaluation of ASB calling performance, it is possible to estimate implicitly the regulatory potential of particular SNPs from functionally related data. We performed a comparison of ASB calls between ADASTRA, BaalChIP, and Shi et al. data comparing ASBs with GTEx eQTLs. The level of eQTL support for ADASTRA ASBs turned out to be comparable to that of the BaalChIP ASB set, with Shi et al. data close behind.

We also studied the association of GWAS-tested phenotypes with all candidate SNVs, not necessarily significant ASBs, found in TF-binding regions. To this end, we performed a general enrichment analysis for SNPs found in ChIP-Seq data of particular TFs within linkage disequilibrium blocks using Fisher's exact test. Thus we identified TFs for which phenotype-associated SNVs were enriched within TF-binding regions. For a number of TFs such association with phenotypes was reported in other studies. The examples include FOXA1 involved in prostate development and in our case, found associated with prostate cancer, IKZF1 for which the protein damaging mutations are associated with leukemia, STAT1 involved in the development of systemic lupus erythematosus, and others. Practically in all cases one or several of the associated SNVs also acted as ASBs of the respective TF, providing strong candidates for causality.

To illustrate how the functional role of regulatory SNPs can be highlighted with ASB data, we present several case studies. First, there is rs three seven six one three seven six G to A that serves as a reference ASB for ESR one, which was already confirmed by electrophoretic mobility shift assay. rs three seven six one three seven six is located in the TFF one gene promoter and was shown to reduce TFF one expression through altered ESR one binding, suggesting a molecular mechanism of the increased risk of gastric cancer.

Next, there is rs one seven two nine three six three two, C to T, that serves as a Ref-ASB for twenty-five different TFs and was previously reported to affect the chromatin accessibility in the adjacent region. rs one seven two nine three six three two is associated with Crohn's disease. This SNP is located in SMAD three intron and overlaps an eQTL targeting SMAD three, AAGAB, and PIAS one genes. Interestingly, a variant of SMAD three is also associated with Crohn's disease, particularly, with increased risk of repeated surgery and shorter relapse. Among the TFs displaying ASBs, there are JUN/FOS proteins with the ASB-concordant motif annotation. The AP one pioneer complex of JUN/FOS likely serves as a "driver" for changes both in gene expression and chromatin accessibility, and is likely to cause ASB of all twenty-five TFs.

Apart from multi-TF ASBs which are linked to local chromatin changes, non-trivial cases can be found among TF-switching ASBs. For example, SNP rs five eight seven two six two one three is associated with psoriasis and is ASB of CREB one, reference allele preference, concordant with motif, and JUN, alternative allele preference. rs five eight seven two six two one three is located in the STX four intron or upstream region depending on a transcript variant. STX four is significantly downregulated in psoriasis, and, according to GTEx, rs five eight seven two six two one three serves as an eQTL of STX four and HSD three B seven; the latter is also reported as psoriasis susceptibility locus.

Another example is SNP rs one one two five seven six five five that is associated with type two diabetes. rs one one two five seven six five five is reported to be located in the CDC one two three regulatory region and exhibits ASB of FOXA one, alternative allele preference, concordant with the sequence motif,

ESR one, reference allele preference, and three other TFs, SPI one, STAT one, and SMC three. According to UniProt, FOXA one is involved in liver and pancreas development, and in glucose homeostasis. At the same time, polymorphisms in the ESR one gene are associated with type two diabetes and with fasting plasma glucose.

Thus, ASBs highlight the cases where phenotype-genotype associations arise with different mechanisms, either from protein structure variation, or due to altered gene expression caused by nucleotide substitutions in the gene regulatory region.


## Discussion

The functional annotation of noncoding variants remains a challenge in modern human genetics. Phenotype-associated SNPs found in GWAS are usually located in extensive linkage disequilibrium blocks, and reliable selection of causal variants cannot be done purely by statistical means. Additional data for the identification of causal variants come from functional genomics. In particular, an important class of causal variants consists of regulatory SNVs affecting gene transcription. For those variants, there are various approaches, e.g., parallel reporter assays, to obtain high-throughput data on molecular events caused by particular nucleotide substitution. Another common strategy is to check if a variant of interest falls into a known gene regulatory region detected by chromatin immunoprecipitation or chromatin accessibility assay followed by deep sequencing. By assessing the allele specificity, it is possible to further profit from these data through direct estimation of the effect that a particular allele has on the binding of relevant regulatory proteins or chromatin accessibility.

In this meta-study, for each SNV, we integrated the data by considering a TF bound to SNV in different cell types or a cell type and different TFs bound to the same SNV. Surprisingly, ASB identification through data aggregation had better sensitivity than standard ChIP-Seq peak calling at the level of individual data sets. Particularly, in GTRD, the ChIP-Seq peak calls were gathered from four different tools, but only eighty-five to ninety percent of significant ASBs were detected within peak calls, suggesting that up to fifteen percent of ASBs could be lost if the ASB calling was restricted to the peak calls only.

Each particular ASB can either be a "driver" directly altering TF-binding affinity, or a "passenger" with differential binding resulting from differential chromatin accessibility, or a protein-protein interaction with the causal TF. In terms of machine learning, we expected the TF ASBs to provide an easier prediction target since they could be mostly determined by the sequence motif of the respective TF. However, as found, the percentage of "passenger" ASBs is rather large, and the TF-specific models showed a limited ASB prediction quality. Further surprise came from cell type-specific models which displayed a notably higher performance. We interpret these data as follows: the cell type ASBs are easier to predict by learning a small set of cell type-specific master regulators, while passenger TF-level ASBs are very diverse, as coming from data aggregation of many different cell types with varying cell type-specific features such as key TFs.

ASB events should be distinguished from other sources of allelic imbalance such as aneuploidy and local CNVs, which can imitate ASB by varying the allelic dosage. Commonly used cell types are often aneuploid: K five sixty-two and MCF seven cells are triploid on average, and fifty-nine of one hundred twenty-one cell types overlapping between ADASTRA and COSMIC also have median copy number above two. The ADASTRA pipeline, to our knowledge, includes the first control-free approach to reconstruct the genomic map of BAD directly from SNP calls and to use this map as a baseline for detecting genuine allelic imbalance. Despite a multitude of available software for ASB calling, there has been no approach suitable for the uniform analysis of diverse existing data. Thus, when developing ADASTRA, the intention was to be able to process and include most of the data including non-replicated experiments, data sets lacking genomic input controls, or with the controls sequenced at low coverage, at the expense of general sensitivity achieved at particular data sets. Further on, such a pipeline might be applicable to other sequencing data that allow allele specificity, e.g., analyses of allele-specific expression or chromatin accessibility. With matched cell types, BAD-corrected data on allele-specific chromatin accessibility will also allow for better classification of driver and passenger ASBs and better application of machine learning techniques.

Our collection of ASB events per se is also useful for other research areas involving TF-DNA interactions. First, ASBs provide unique in vivo data on differential TF binding and can be used for testing the predictive power of computational models for precise recognition of TF-binding sites. Second, the TF binding not only affects transcript abundance, but also affects RNA splicing, localization, and stability. Thus, ASBs may affect other levels of gene expression, particularly, the mRNA post-transcriptional modification: out of sixty-five RNAe-QTLs reported, four are listed as ASBs in ADASTRA.

Last but not least, ADASTRA reports hundreds of TF-switching ASBs, where alternative alleles are preferably bound by different TFs. This possibility has been discussed previously but, to our knowledge, we are first to report the genome-wide inventory of such events. Importantly, the respective SNVs exhibit the highest enrichment with phenotype associations. Probably these sites serve varying and allele-dependent molecular circuits. A particularly interesting example is rs two eight three seven two eight five two located in the G elongation factor mitochondrial one gene promoter. According to ADASTRA, rs two eight three seven two eight five two serves as the Alt-ASB of CREB one and Ref-ASB of MXI one, and in both cases, the allelic imbalance is concordant with the respective binding motifs. Also, according to GTEx, GFM one is the target of rs two eight three seven two eight five two eQTL. According to UniProt, CREB one is a transcriptional activator, while MXI one is a transcriptional repressor, suggesting that ASB can directly switch the gene expression activity. At the same time, UniProt reports four amino acid substitutions in GFM one that are associated with combined oxidative phosphorylation deficiency. Interestingly, according to ClinVar, this SNP is benign in regard to combined oxidative phosphorylation deficiency; and in this case we speculate that ASB data might facilitate reevaluating the variants' functional roles and pathogenic potential. We believe that further analysis of TF-switching ASBs in the scope of metabolic and regulatory pathway alterations will provide valuable insights into molecular mechanisms underlying particular normal and pathologic traits.


## Methods

Variant calling from GTRD alignments. We used seven thousand six hundred sixty-nine premade short read alignments against hg thirty-eight genome assembly produced with bowtie two and stored in the GTRD database. PICARD was used for deduplication, followed by GATK base quality recalibration. Next, the variants were called with GATK HaplotypeCaller, with dbSNP common variant set of the build one hundred fifty-one for annotation. The must be listed as an SNP in the dbSNP one hundred fifty-one common set. Of note, we considered all eligible SNVs as candidate ASB, not necessarily located within ChIP-Seq peak calls.

We restricted ourselves with variants from the the following reasons: (one) allelic read counts at de composition of the cell population rather than the local copy-number ratio or ASB; (two) de novo point mutations within particular copies of duplicated segments duplications will exhibit allelic imbalance and may lead to false-positive ASB calls.

Accounting for BAD. The observed distribution of ChIP-Seq allelic read counts on heterozygous SNVs significantly depends on aneuploidy and the CNV profile of the cells. The modes of distribution correspond to the most represented copy number, e.g., the distribution is bimodal for mostly triploid K five six two cells. However, the mixture of two Binomial distributions poorly approximates the data, showing a significant overdispersion. To systematically reduce the overdispersion from local CNVs and aneuploidy, we reconstructed the genome-wide BAD maps from read counts at the heterozygous variants. The distributions of the allelic read counts at SNVs segregated by BAD show a notably reduced overdispersion.

BAD calling with Bayesian changepoint identification. To construct genome-wide BAD maps from filtered heterozygous SNV calls, we developed a novel algorithm, the BAD caller by Bayesian changepoint identification.

At the first stage, BABACHI divides the chromosomes into smaller sub-chromosome regions by detecting centromeric regions, long deletions, loss of heterozygosity regions, and other regions depleted of SNVs. At this stage, only the distances between neighboring SNVs are taken into account and long gaps are marked. The sub-chromosome regions with fewer than three SNVs or chromosomes with one hundred each sub-

X equals the minimum. Be distributed according to the truncated Binomial distribution given that the number of reads overlapping the variant; the number of successes k is limited to five is less than or equal to k is less than or equal to n minus five, the read coverage filter, and P is either one divided by the quantity BAD plus one or BAD divided by the quantity BAD plus one, matching one of the expected allelic read frequencies.

BAD of each segment is selected from the discrete set one, four thirds, three halves, two, five halves, three, four, five, six, considering that the total copy number of a particular genomic region rarely exceeds seven. The prior distribution of BAD is assumed to be a discrete uniform, with the support being the same discrete set as above, non-informative prior. Details and mathematical substantiation of the algorithm are provided in the Supplementary Methods.

Practical BAD calling with the ADASTRA pipeline. To provide better genome coverage and robust BAD estimates, we merged the sets of variant calls from ChIP-Seq data sets produced in the same laboratory for the same cell type and in the same series, i.e., sharing either ENCODE biosample or GEO G S E ID. Different SNVs at the same genome position, either originating from different data sets or with different alternative alleles, were considered as independent observations. For each data set, chromosomes with fewer than one hundred SNVs were excluded from BAD calling and further analysis.

To assess the reliability of the BAD maps, for each BAD, we separately estimated ROC and PRC. Here we considered the BAD maps as binary classifiers according to BAD, with COSMIC CNV data as the ground truth. To plot a

S equals L of BAD equals x minus the maximum of L of BAD equals y, the segment containing the SNV to have the

Construction of an independent BAD map for MCF seven cells. The paired-end reads of MCF seven deep genome sequencing (SRA accession S R R eight six five two one zero five) were aligned to hg thirty-eight genome assembly using bowtie two with default settings. Overall, twenty-eight million, two hundred seventy-eight thousand, twenty-six, two point five percent of a total of one billion, one hundred thirty-six million, six hundred sixty-six thousand, five hundred sixty paired reads were marked as duplicates, one hundred twelve million, three hundred twenty-three thousand, nine hundred twenty-five, nine point nine percent were filtered by GATK filter by mapping quality greater than or equal to ten, leaving nine hundred ninety-six million, sixty-four thousand, six hundred nine reads for SNP calling. A total of three million, nine hundred sixty-nine thousand, two hundred fifty SNPs was reported by GATK HaplotypeCaller, among which one million, four hundred twenty-seven thousand, four hundred ninety-two SNPs were annotated as heterozygous, passed the basic ADASTRA filter, greater than or equal to five reads on each allele, and were used to produce the independent reference MCF seven BAD map with BABACHI sixty-nine.

ASB calling with the Negative Binomial mixture model. To account for mapping separate Negative Binomial mixture models for the scoring of Ref-and Alt- ASBs. For each BAD and each fixed read count at Ref- and Alt- alleles, we obtained separate fits using SNVs from all available data sets.

For every fixed read count value at a particular allele, we approximated the distribution of read counts mapped to the other allele as a mixture of two Negative Binomial distributions. The model estimates the number of successes X, the number of reads mapped to the selected allele, given the number of failures R, the number of reads mapped to the second allele, in the series of Bernoulli trials with probability of success P for the first distribution in the mixture or one minus P for the second distribution in the mixture. The following holds for scoring Ref-ASBs at a fixed Alt-allele read counts:

C Alt follows a distribution according to the quantity one minus W times Negative Binomial of R and P plus W times Negative Binomial of R and one minus P.

P equals CRef equals x given fixed CAlt equals m, CRef greater than or equal to five equals open parenthesis X plus R minus one close parenthesis choose X open parenthesis open parenthesis one minus W close parenthesis times open parenthesis one minus P close parenthesis to the power of R times P to the power of X plus W times open parenthesis one minus P close parenthesis to the power of X times P to the power of R close parenthesis divided by A A equals one minus P open parenthesis C sub Ref less than five given fixed C sub Alt equals M close parenthesis one where P and one minus P were fixed to reflect the expected frequencies of allelic reads, namely, one divided by open parenthesis BAD plus one close parenthesis and BAD divided by open parenthesis BAD plus one close parenthesis. The parameters R (number of failures) and W (weights of distributions in the mixture) were fitted with L-BFGS-B algorithm from scipy.optimize package to maximize the model likelihood iteratively with boundaries R greater than zero and zero less than or equal to W less than or equal to one, assigning initial values of R equals M (number of reads on the fixed allele) and W equals zero point five, respectively. A is the normalization coefficient (necessary due to truncation) corresponding to allelic reads cutoff of five. The goodness of fit was assessed by root mean square error of approximation (RMSEA, Supplementary Figure eleven). Low-quality fits with RMSEA greater than zero point zero five were discarded, fixing the parameters at R equals M and W equals one, thereby penalizing the statistical significance of ASB at such SNVs, as fitted R is systematically lower than M (Supplementary Figure twelve). Of note, the values of R for distribution of reference allele read counts (with fixed alt-allele read counts) were systematically higher than those for alternative allele read counts (with fixed Ref-allele read counts), thus balancing the reference mapping bias. The obtained fitted models were used for statistical evaluation of ASB for alternative and reference alleles independently, with one-tailed tests. Examples of fits for BAD equals in Figure six E, F, with RMSEA less than zero point zero two for the fixed Ref/Alt read counts of ten. Aggregation of ASS P values from individual datasets. For external validation we performed the ASB calling. Next, the SNVs were grouped by a particular TF across cell types or by a particular TF. A group of SNVs with the same position and alternative alleles was considered as an ASB candidate if at least one of the SNVs passed a total coverage threshold greater than or equal to twenty. Next, for each ASB candidate, we performed logit aggregation of individual ASB P values, independently for Ref-ASB and Alt-ASB. Individual P were excluded from aggregation, and if none were left, the aggregated P

Logit aggregation is the method of choice, as it has two advantages. First, P values can arise both from a small number of strongly imbalanced SNVs in deeply

ASB effect size estimation. We define the ES separately for reference allele ASB open parenthesis ESR close parenthesis and alternative allele ASB open parenthesis ESA close parenthesis as the log ratio of the observed number of reads to the expected number. To account for BAD and mapping bias, we use fitted Negative Binomial mixture at the fixed allele read counts:

E S sub R e f equals log base two of open parenthesis C sub R e f divided by E of open parenthesis C sub R e f vertical bar C sub A l t close parenthesis close parenthesis, E S sub A l t equals log base two of open parenthesis C sub A l t divided by E of open parenthesis C sub A l t vertical bar C sub R e f close parenthesis close parenthesis.

In the basic case of BAD equals one, the E S can be approximated as the log ratio of read counts, taking into account that the expectation bias due to the truncation is relatively small and r is close to the read count on the fixed allele: E S Ref equals log base two of open parenthesis C Ref divided by C Alt.

In the case of B A D is greater than one, the same assumptions lead to the following estimation of the E S:

log base two of open parenthesis C sub R e f times B A D divided by C sub A l t close parenthesis is approximately less than or equal to E S sub R e f is approximately less than or equal to log base two of open parenthesis C sub R e f divided by open parenthesis B A D times C sub A l t close parenthesis close parenthesis.

This holds due to the fact that for fixed BAD, C sub Ref expectation is either C sub A l t times BAD or C sub A l t divided by B A D, depending on a haplotype. Therefore, the expectation of C sub Ref according to the Negative Binomial mixture model is approximately w times C sub A l t times B A D plus open parenthesis one minus w close parenthesis times C sub A l t divided by B A D. The final A S B E S is estimated for S N Vs with aggregated significance either across T Fs or across cell types. The E S value is calculated as a weighted average of E S of individual S N Vs in aggregation, with weights assigned as negative logarithms of individual P values. E S is not assigned in the case if all individual P values are equal to one.


## SNV and ASB annotation

Genomic annotation. To annotate SNVs according to their genomic location, we started with mapping SNVs to FANTOMfive enhancers and promoters. The remaining SNVs were annotated with ChIPseeker with a hierarchical assignment of the following categories: promoter (less than or equal to one kilobase), promoter

(one to two kilobases), promoter (two to three kilobases), five prime UTR, three prime UTR, Exon, Intron, Downstream, Inter-genic. For clarity, promoter (less than or equal to one kilobase) and five prime UTR categories were both tagged as "promoter"; promoter (one to two kilobases) and promoter (two to three kilobases) were both tagged as "upstream."

Sequence motif analysis of ASBs. For TF ASBs, we annotated the corresponding SNVs with sequence motif hits of the respective TFs. To this end, we used models from HOCOMOCO version eleven core collection and SPRY-SARUS for motif finding. The top-scoring motif hit was taken considering both Ref and Alt alleles, and, at this fixed position, the "motif FC" was calculated as the log two ratio of motif P values at the reference and alternative variants so that the positive FC corresponded to the preference of the alternative allele.

To analyze the ASB motif concordance, we considered the ASB SNVs (min FDR Ref less than or equal to zero point zero five that overlapped the predicted TF-binding site: (min motif P value Ref motif P value Alt less than or equal to zero point zero zero zero five, and had FC absolute value greater than or equal to two. We defined the motif concordance or discordance as a match or mismatch of the signs of FC and

Delta F D R equals log base ten F D R Alt minus log base ten F D R Ref. Annotation of ASBs with phenotype associations. To assess enrichment of ASBs within phenotype-associated SNPs, we used the data from four different SNP-phenotype associations databases, namely: one) NHGRI-EBI GWAS catalog, release August twenty-seventh two thousand nineteen with EFO mappings used to group phenotypes by their parent terms for Supplementary Figure nine; two) ClinVar catalog, release September fifth two thousand nineteen (entries with "likely pathogenic," "pathogenic," or "risk factor" clinical significance); three) PheWAS catalog; four) BROAD fine-mapping catalog of causal autoimmune disease variants. All entries were systematized in the form of triples, dbSNP ID, phenotype, database. Next, the entries were annotated with the TF- or cell type-ASB data.

To evaluate TF-phenotype associations in detail, we used NHGRI-EBI GWAS catalog and the following pipeline:

one) We filtered out TFs with less than two candidate ASBs, and phenotypes associated with less than two SNPs, resulting in seven hundred sixty-five TFs and two thousand six hundred eighty-eight phenotypes suitable for the analysis. For each TF, we considered all SNPs with candidate ASBs passing the coverage thresholds.

two) For each pair of a TF and a phenotype, we calculated the odds ratio and the P value of the one-tailed Fisher's exact test on SNPs with candidate ASBs considering two binary features: whether the SNP is associated with the phenotype, and whether the SNP is included in ASB candidates of the particular TF. The superset of SNPs was collected independently for each TF by gathering SNPs with candidate ASBs for all TFs but only from LD blocks containing either TF-specific SNPs or phenotype-associated SNPs. The P values were then FDR corrected for multiple tested TFs separately for each phenotype.

Analysis of eQTLs and eQTL target genes. To analyze an overlap between ASBs and eQTLs, we used significant variant, gene pairs from GTEx (release Veight).

To evaluate ASB-driven eQTL target genes' associations with medical phenotypes, a one-tailed Fisher's exact test was performed on the enrichment of protein-coding genes of medical relevance (six thousand twenty-six genes found linked with entries with "pathogenic," "likely pathogenic," or "risk factor" clinical significance in Clin Var catalog) among eQTL target genes of ASB SNPs (sixteen thousand eight hundred sixty-five protein-coding genes according to GTEx), considering all human protein-coding genes from GENCODE (version thirty-five, nineteen thousand nine hundred twenty-nine gene symbols) as the background set.

ASB prediction with machine learning. In our work, we used a standard software implementation of the random forest model from the scikit-learn package. The number of estimators was set to five hundred and the other parameters were defaults. Three feature types were used: allele-specific chromatin DNase accessibility, synthetic data from neurons from the last layer of the DeepSEA, and HOCOMOCO motif predictions obtained with SPRY-SARUS. As a global set of SNVs, we used two hundred thirty-one thousand three hundred fifty-five dbSNP IDs overlapping between ADASTRA and Maurano et al. data, which provided allele-specific DNase accessibility. For the general model, we used SNVs with ASBs for any of TFs or in any of cell types as members of the positive class, and the remaining set of candidate SNVs as members of the negative class. For TF- and cell type-specific assessment, we defined ASB and non-ASB SNVs for a particular TF or in a particular cell type as the positive and negative class, respectively.


## Data availability

Code availability

Received: fifteen October two thousand twenty; Accepted: twelve April two thousand twenty-one; Published online: twelve May two thousand twenty-one


## Author contributions

Competing interests

The authors declare no competing interests.