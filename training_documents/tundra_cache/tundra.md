## ENVIRONMENTAL RESEARCH COMMUNICATIONS

Twenty centimeter resolution mapping of tundra vegetation communities provides an ecological baseline for important research areas in a changing Arctic environment

PAPER Twenty centimeter resolution mapping of tundra vegetation communities provides an ecological baseline for important research areas in a changing Arctic environment


## Abstract

Arctic tundra vegetation communities are spatially heterogeneous and may vary dramatically from one meter to the next. Consequently, representing Arctic tundra vegetation communities accurately requires very high resolution raster maps (less than five meter grid cell size). However, using remotely sensed data to produce maps with sufficient spatial detail at an extent appropriate for understanding landscape-scale ecological patterns is challenging. In this study, we used predictor layers derived from airborne lidar and high-resolution (approximately five centimeter) four-band airborne imagery to classify vegetation communities at twenty centimeter spatial resolution for three landscapes (twelve point five square kilometers total) near the Toolik Lake research area in the Alaskan Low Arctic. The maps were built using a Random Forest model that was trained and tested on eight hundred ground reference plots, using classes derived from commonly used legends on existing polygon maps of the area. Withheld test plots (twenty-five percent of dataset) had a balanced map accuracy of zero point five seven, kappa of zero point four seven, and weighted (fuzzy) kappa of zero point six five. These maps provide high-resolution plant community information that can serve as important baseline reference data for vegetation monitoring and change detection in this rapidly changing tundra ecosystem, and as validation for coarser scale maps. They also permit fine-scale characterization of landscape phenomena such as community-level nutrient dynamics and wildlife habitat suitability in an important Arctic research site. Our approach demonstrates that very high resolution mapping results can be achieved and validated by integrating high-resolution remote-sensing datasets from multiple sensors in a machine learning model trained on simple field reference data.


## One. Introduction

As the Arctic continues to warm rapidly, research efforts seeking to improve understanding of potential impacts on human, animal, and vegetation communities are becoming increasingly urgent. To address these challenges, there is often a need to understand the distribution of features across the landscapeâ€”for example, to understand how much area is covered by lakes and wetlands that may release increasing quantities of methane, or which permafrost slopes might soon thaw and erode, impacting local and downstream terrestrial, aquatic, and human communities and releasing ancient soil carbon to the atmosphere.

The spatial requirements for mapping these landscape features in a scientifically relevant way depend on the ecological change process under study. Coarse to moderate resolution classification maps covering large extents provide valuable information about general surface features, and can be important inputs to regional and global climate models. However, the low spatial resolution and usually coarse classification schemes of these mainly satellite-derived maps cannot represent the heterogeneity of Arctic landscapes accurately enough to reproduce the distribution of diverse vegetation community types or fine-scale ecological phenomena. Capturing the natural variability of Arctic tundra surfaces across complex environmental gradients requires surface mapping at very high spatial resolution, generally five meters or less. For example, very high spatial resolution mapping is necessary for identification of suitable nesting habitat for migratory songbirds that require open, dry hillsides, and for determining whether individual patches of small shrubs growing along narrow waterways are expanding. On the other hand, classification maps derived from unmanned aerial systems may be of very high spatial resolution, but the spatial extent of such datasets may be restricted by short flight times and other logistical considerations, limiting their general usefulness. High-quality piloted-airborne datasets therefore still represent a gold standard, with the potential for producing high-resolution data products at the moderately large spatial extents necessary for understanding landscape-level influences on fine scale vegetation change.

Fusing lidar and passive optical data produces a robust combination of structural and spectral information for a surface, and consequently this has proven to be a powerful approach to quantifying geospatial features. For example, Reese found that combining lidar and optical metrics improved classification of low-stature vegetation in an alpine zone over optical data alone, and Greaves similarly found that this approach produced strong models for quantification of shrub biomass in Arctic tundra.

Our objective was to fuse high-quality lidar and optical datasets to produce tundra vegetation community maps with the high spatial resolution and fine classification granularity necessary to be relevant for the study of fine-scale ecological features at a landscape extent. We used predictor layers derived from airborne lidar and multispectral imagery along with simple field reference data to train a Random Forest model to classify vegetation communities at twenty centimeter resolution across three research areas near Toolik Lake (twelve point five square kilometers total), an area of important long-term and ongoing Arctic ecological research.


## Two. Methods

Two point one. Study area

The study was conducted near the Arctic Long Term Ecological Research site at Toolik Lake. Located on continuous permafrost tundra in the northern foothills of the Brooks Range, the Toolik Lake area has been an important site for North American Low Arctic research since the nineteen seventies. The region is characterized by cold winters (mean coldest month temperature negative thirty degrees Celsius) and mild summers (mean warmest month temperature thirteen degrees Celsius), with roughly three hundred millimeters of precipitation annually. Complex topography, glacial features, and prevailing weather patterns (notably scouring southerly winds) generate a complex mosaic of microenvironmental gradients driven by parent material, exposure, and drainage, which in turn host a finely heterogeneous patchwork of low-stature tundra vegetation communities. The dominant vegetation is graminoid tundra (especially Eriophorum vaginatum and Carex bigelowii) with abundant Sphagnum and other mosses and erect deciduous shrubs, mainly Betula nana and Salix species.


## Two point two. Data collection

Two point two point one. Airborne data collection roughly four point two five centimeter. A GPS check of forty stationary objects distributed across the Toolik footprint suggested that the imagery was accurately orthorectified to within approximately ten centimeters.


## Two point two point two. Reference plot photo collection

Field reference data were collected from across all footprints in summer twenty fourteen and summer twenty fifteen. The majority of plot locations were established in advance using a stratified random scheme to ensure inclusion of wide ranges of slope, aspect, elevation, and glacial history across all footprints. An additional forty-seven plots were collected in the course of visiting the stratified random plots, to capture a wider range of shrub characteristics, and ninety-two more plots were collected in twenty fifteen to represent additional shrub types and vegetation across topographic transects. For each of these seven hundred thirty-one total field plots, we took nadir photographs from approximately one meter height using a standard point-and-shoot consumer digital camera, capturing roughly one by one point three meters of ground area. We also recorded brief notes at each plot describing plant species and surface features present in the plot and the general area, including vegetation height measured using a meter stick; thaw depth measured using a steel thaw probe; and moss plus organic soil depth, measured using a meter stick after slicing a slit in the moss or organic mat with a serrated knife. The center coordinates of each plot photo were precisely measured using a TopCon GR three survey grade GNSS system operating in real-time kinematic mode.


## Two point three. Reference plot classification

This area has benefited from previous vegetation classification efforts, in particular by the Alaska Geobotany Center at the University of Alaska, Fairbanks, which has produced a hierarchical series of maps for the area depicting multiple landscape features. These include vegetation maps that provided a valuable benchmark for this project. Vegetation classes for the Alaska Geobotany Center maps were established using the Braun-Blanquet classification approach, in which species associations are grouped into a hierarchy of successively broader units. The classification system has the potential to precisely describe the finely heterogeneous vegetation community distribution of the Toolik Lake area, but the maps have limited or absent map accuracy information, and are polygon-based rather than raster, with varying minimum mapping units that necessarily simplify the distribution and arrangement of vegetation patches on the landscape. Since it was desirable that the final map classes in this project correspond as well as possible with legends used on previous maps, preliminary vegetation classes for this project were established by examining communities described in available maps and literature. To assign each plot photo to a plant community, photo order was randomized, and each photo was visually examined. Based on plant species and other features visible in the photo, as well as plot notes, each plot location was assigned to the class that best described the center of the photo, where GNSS coordinates had been measured. Because it wasn't yet clear how well we would be able to distinguish vegetation classes in the final model, initial class assignments were as granular as possible, to permit more flexible subsequent grouping. Finally, sixty-nine additional reference plots locations were selected from the orthophotos, to provide more reference data for gravel pads, blockfields, and open water classes that were underrepresented in the field data but could be confidently identified in the orthophotos.


## Two point four. Input data layer processing

A total of thirty-three predictor variable layers at twenty centimeters resolution were derived from the airborne lidar and RGBN imagery using a variety of tools. Most layers fall into three general categories: lidar-derived canopy metrics, lidar-derived topographic metrics, and first-order imagery metrics. Additionally, there is one compound layer, shrub biomass, which was derived previously using lidar canopy metrics and NDVI and downscaled to twenty centimeters resolution for use here. We also included lidar return intensity, which acts as a surface metric. The raw intensity of near-infrared fifteen hundred nanometers laser returns is affected by surface characteristics, especially wetness, surface roughness, and the presence of green vegetation, making it a potentially valuable predictor of surface features and vegetation distribution. Although our intensity data are not radiometrically calibrated or normalized, the intensity response showed few flight-line artifacts, and the nonparametric nature of the Random Forest modeling approach permits the inclusion of raw, uncorrected data. All predictor metrics were selected to be ecologically meaningful for Arctic vegetation distribution, as well as being likely to improve prediction of vegetation characteristics based on previous work.

Owing to the prevalence of noise in data layers with such high resolution, most layers were smoothed using a circular mean Focal Statistics filter. This type of smoothing retains the original spatial resolution, but tends to improve classification predictions by decreasing the impact of meaningless local variation, instrument noise, and small shadows. We initially processed layers at several smoothing distances (zero point five meters, zero point seven five meters, one meter, one point two five meters), but we only retained layers that appeared important in preliminary models and had a Spearman correlation less than zero point ninety-five at the reference plot locations. Once the layers were prepared, the values of all predictor layers at the location of each reference plot were extracted for model training and validation.


## Two point five. Random forest modeling

Random Forest is a machine learning algorithm that uses ensembles ('forests') of classification or regression trees. In a Random Forest, each tree selects and permutes random subsets of predictor variables at each splitting node, which reduces overfitting and improves the strength of predictions. Additionally, Random Forest is non-parametric, models local interactions naturally, and is relatively robust against the collinearity common to ecological variables, making it an effective tool for ecological research.

We implemented Random Forest using the package 'randomForest' along with model training tools in the package 'caret' in the R statistical language. Twenty-five percent of the reference data plots (selected proportionally from each class; one hundred ninety-six plots total)

a Smoothing, summing, and standard deviations were performed using ArcGIS Focal Statistics in Spatial Analyst via arcpy in Python.

b Canopy and terrain heights estimated from lidar as described in Greaves and others.

c Calculated from RGBN imagery via the 'raster' package in R.

e Hue derived from RGBN imagery via ENVI.

f Raw intensity gridded using LAStools.

g Implemented in SAGA GIS via the 'RSAGA' package in R.

were withheld from model building to be used as a test dataset; the remaining seventy-five percent of the plots were used to build the model. One model was built to predict all three footprints.

Because the Random Forest algorithm strives to produce the best overall accuracy, it is susceptible to producing poor accuracy for small classes in imbalanced datasets. Since our input dataset was imbalanced, we used an upsampling algorithm implemented in the caret package to ensure equal weighting of each class. The model building was an iterative process: we used out-of-bag error rates and confusion matrices from early models to determine which classes could not be differentiated, then collapsed input classes accordingly and retrained the model, seeking a balance between accuracy and retention of informative classes. The final class names and reference plot membership counts are in table three. We also used tools in the caret package to tune the number of trees and the number of variables selected for splitting at each tree node based on five-fold cross-validation repeated ten times. We found that any number of trees greater than five hundred and any value of mtry less than approximately six gave largely similar results. The final model used one thousand one trees and an mtry of one.


## Two point six. Mapping

After building the final Random Forest model, we applied it across the three data collection footprints using the AsciiGridPredict tool in the R package 'yaImpute'. Once the initial maps were built,

pixels in class patches smaller than twenty-five pixels (one square meter) were replaced by the surrounding majority class; therefore, while the map spatial resolution is twenty centimeters, the minimum mapping area is one square meter. Queen-related pixels (pixels touching only at one corner) were considered to be connected to each other, so one square meter patches may not appear as cohesive blocks. Minor manual cleanup was performed to correct pixels where infrastructure had been classified as vegetation on the Toolik Field Station gravel pad. Some misclassifications of other infrastructure on the landscape, such as boardwalks, remain uncorrected but are apparent to the human eye.

To evaluate the accuracy of the map, we extracted the final mapped class at the location of each withheld test plot. From these mapped locations, we determined the overall accuracy, balanced accuracy, Cohen's kappa, and Cohen's weighted kappa. Like Cohen's kappa, Cohen's weighted kappa quantifies the overall agreement after accounting for agreement occurring by chance, but it also permits the investigator to subjectively indicate the degree of disagreement present. Given that vegetation classes are discrete labels that represent gradients of species abundance and structure, and given that our class labels were highly granular, it is reasonable to treat some disagreements as more or less serious in this way. For example, in most applications it would be considerably less serious to confuse Tussock Tundra with Shrubby Tussock Tundra than to confuse it with Tall Shrub. Detailed descriptions of the classes are in table S3.


## Three. Results and discussion

Three point one. Model and map accuracy

Random Forest upsampled out-of-bag overall accuracy was zero point eighty-six, with a kappa of zero point eighty-five and weighted kappa of zero point ninety-one. Based on extraction of final mapped classes for withheld test plots, overall map accuracy was zero point fifty-two, and balanced (mean class-wise) map accuracy was zero point fifty-seven. Kappa was zero point forty-seven for the mapped withheld plots, indicating moderate agreement. Weighted kappa was considerably higher (zero point sixty-five), suggesting that many disagreements were relatively minor in an ecological sense. The confusion matrix shows that the main confusion was among shrubby classes and among moist upland classes, which was expected because these classes grade into each other on the landscape. Mean user's accuracy was slightly higher than mean producer's accuracy (zero point sixty-three versus zero point fifty-seven). The confusion matrix also illustrates that although the withheld test data represented twenty-five percent of all reference data, the imbalanced class sizes led to very small withheld sample sizes for small classes (as small as four members, mean thirteen); this makes the accuracy metrics more difficult to interpret, since there were relatively few opportunities to test accuracy in these smaller classes.


## Three point two. Sources of error and challenges of high-resolution mapping

The logistics of mapping at twenty centimeters resolution exacerbates uncertainty, especially in the context of such a finely heterogeneous landscape. At such a high resolution, unavoidable sub-meter errors in data collection and processing become important, but remain difficult to quantify. These errors might include small artifacts from imagery stitching and orthorectification; minor spatial variations in lidar ground-control adjustments; centimeter-level errors in GNSS base station location or RTK corrections; and slight mismatches in the location of a reference plot photo center and the measurement of its GNSS coordinates-any of which could displace a reference plot into the wrong pixel and introduce noise into the modeling process. Indeed, the large difference between the value for kappa and weighted kappa suggests that many misclassifications are attributable to small ecological (gradient-related) offsets or locational errors in the data.

Nonetheless, we believe that the high resolution of the maps, their relatively large extent, and the granularity of the classes offset the moderate map accuracy we were able to achieve, especially given the challenges inherent in any vegetation classification. For example, the gradient nature of vegetation communities can make class assignment for a plot ambiguous, since a given location may show characteristics of multiple vegetation communities. This might lead to two similar training plots being assigned to different classes based on an arbitrary distinction, introducing noise to the training data. The granularity of our classification scheme also increases opportunities for confusion. For example, there were five shrubby classes, many of which are structurally similar, as well as two common classes (Tussock Tundra and Moist Non-Tussock Tundra) that each had a corresponding 'Shrubby' class. These 'Shrubby' versions would only be differentiable from their non-shrubby counterparts based on the presence of sparse, low-stature shrubs (less than thirty centimeters height), which are difficult to detect in remotely sensed data. Nonetheless, we retained the granular classes because we believe the maps accurately reflect landscape vegetation patterns, and that this classification will be most valuable to map users.


## Three point three. Predictor importance

Although the Random Forest approach is valuable for its flexibility and robustness, it provides only limited options for ecological interpretation of results. Variable importance metrics are derived by examining how much the accuracy (both class-wise and overall) changes when the model is run iteratively with the values of each predictor permuted (i.e., randomly reordered among plots). However, variable importance metrics become less meaningful when input variables are highly correlated, as they are in this study, so it is not advisable to interpret the variable importance values rigorously in this case.

With that caveat, some results are interesting. For example, lidar intensity was important to accuracy for several classes, with standard deviation of intensity especially important for very wet vegetated classes (Raised Areas in Wet Tundra, Wet Tundra), where the occurrence of intermixed high- and low-intensity pixels could indicate areas of intermixed vegetation and saturated microsites. Intensity smoothed at one meter was the predictor with the largest impact on the overall Gini purity index and was especially important for very dry vegetated classes (Dry Exposed Tundra, Dry Sheltered Tundra) where intensity would be high, and for Water, where intensity would be low. This adds to emerging evidence that lidar intensity can be an important ecological metric.

Greenness indices (NDVI, DSI, TwoGRBI) were important for predicting all shrubby classes, as would be expected, and coarse-scale topographic position was important for predicting Low to Tall Moist Shrub, which generally occurs in low-lying streambed areas. Unsurprisingly, lidar-derived canopy height metrics were important for predicting Tall Shrub, and heat load index was important for predicting Moist Snowbed-but it was somewhat more surprising that percent red appeared important for predicting wet tundra classes (Wet Tundra, Raised Areas in Wet Tundra) and moist upland tundra classes (Moist snowbed, Tussock Tundra, Moist Non-Tussock Tundra), perhaps owing to a comparatively high degree of red absorption by both water and plants in those areas. The standard deviation of the panchromatic (R plus G plus B), although not at all important for most classes, was highly important for predicting Tussock Tundra, where high values may have indicated the distinctive speckled image texture created by tussock shadows. Indeed, in our early modeling attempts, which employed one meter spatial resolution rather than twenty centimeters, we found that models could not distinguish tussock tundra from non-tussock tundra, perhaps owing to dilution of this signal when averaged over a larger area.

Overall, in a list of fifteen most important predictors per class, all thirty-three predictors appear for at least one class; in a list of the five most important variables per class, only seven predictors fail to appear for at least one class. Although this may be due in part to the correlated nature of many of the predictor variables, the wide variety of variables appearing as important for different classes also suggests the complicated interrelationships between vegetation communities and their ecological drivers.


## Three point four. Mapping

greenness at the outer margins of the flight line, while simultaneously reducing the prominence of tussock shadows. Overall, the maps correspond well to previous polygon maps of the area and to the authors' knowledge of the mapped landscapes.


## Four. Conclusion

This project combined predictor datasets derived from two airborne sensors in a machine learning approach that permitted the construction of very high-resolution validated vegetation classification maps based on simple ground reference data. The approach highlights the ability of high-quality airborne data to produce very high-resolution geospatial data products over relatively large areas, providing an important link between limited- extent ground- and UAS-based remote sensing products and coarser geospatial data products covering larger extents. The maps should prove to be a valuable resource for Arctic researchers requiring fine-scale reference data for these important research landscapes.


## Data availability

The vegetation classification maps and ground reference photo collection are available for download at the Oak Ridge National Laboratory Distributed Active Archive Center.