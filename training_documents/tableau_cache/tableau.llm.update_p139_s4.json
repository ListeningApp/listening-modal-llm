{
  "id": "chatcmpl-A3UEMCUdosHqKp9aSmeq6G6gNwygT",
  "choices": [
    {
      "finish_reason": "stop",
      "index": 0,
      "logprobs": null,
      "message": {
        "content": "lxvt | We duplicated the sheet on which we were working and then dragged the percent differences of the Remittances per Capita field to the Measures pane, where we renamed it to Remittances per Capita Percent Difference from Average, as shown in the following screenshot:\nj2lw | In the formula box, Tableau Public calculates the value for each year, subtracts the value of the first year from it, and divides it with the value for the first year.\n54ha | The following are a few new functions in this formula:\nl0ba | . ZN: This means that Tableau Public uses zero if the value is null.\nlrx9 | . LOOKUP: This finds a value specified by an offset from the current value. In this case it's negative one, which means the previous value, but it could be anything. The other values are the FIRST() and LAST() functions.\ncuje | . ABS: This takes the absolute value of the previous value. When writing table calculations, you should always use ZN and ABS, even if you think you don't need them at the time, because you do not necessarily know what will be in your data set in the future.\nhf27 | In order for this to be the percent difference from the average, change the references to the first value to the references to the WINDOW_AVG.\njeod | . Replace LOOKUP with WINDOW_AVG.\nb4sp | . Then, delete both instances of the string and the FIRST() function, because in this case, the WINDOW_AVG does not need an offset, like we had in the previous exercise. We want to use the average for the whole partition.\noyus | Chapter six\nhszm | The new formula looks like the one shown in the following screenshot:\na8y7 | Ranking\nf5j1 | Our examples so far have focused on comparing measures that occur along a time continuum. Table calculations are useful for a comparison between different dimensions as well. Ranking by discrete numbers, as well as percentiles, is powerful. Many people want to know the top or bottom number of members in a dimension. In the next example, the final product shows the bottom twenty percent of the countries in each region according to their availability of improved water sources, and each country will be colored by its percentile of life expectancy.\n663c | Start off by creating a basic bar graph from the World Development Indicators data source that shows the maximum percentage of a country's population that has access to improved water sources. Drag Region and Country to the Rows shelf. Then, when we drag Improved Water Source (percent) to the Columns shelf, we aggregate it as a maximum rather than a sum. Select MAX based on the assumption that unless there's a major natural disaster (such as floods and earthquakes, which were used as data points in the previous chapter) or war, it's unlikely that the access to clean water will decrease.\n8ujr | Then, sort the countries in the ascending order by clicking on the sort icon on the x axis.\n50u2 | The real ranking tasks begin here, with the label. The objective is to show the bottom twenty percent by region. So, we need to do several things along the way that help explain the ranking functionality. Perform the following steps:\n7pc2 | One. Drag Improved Water Source (percent) to the Label shelf.\niy56 | Two. Then, click on it and select Quick Table Calculation.\nb0zn | Three. The Quick Table Calculation that we selected is Rank. Then, drag the field to the Measures pane and rename it to Country Rank - Water.\nvgh5 | Level of Detail and Table Calculations\nj0y0 | Four. Check out the snippet of the visualization in the following screenshot; each country is ranked in the descending order by the percentage of citizens who have access to clean drinking water:\nktcv | Five. Note that the countries are ranked as a part of the whole table. We would like to rank them by region. Therefore, click on the pill, which is present on the Label shelf, select Compute using, and choose Pane (down).\ne8zh | Six. To the lower-right of the visualization, there is an indicator that we have several null values. This is because some of the countries have not reported these data points. Click on the indicator to exclude the countries with null values.\nrqcv | Seven. There are other functions, such as INDEX(), that perform similar tasks, except that INDEX() actually produces the row number in the partition and not the rank. If you change the sort order of the countries shown, the labels stay the same; wherever you see Somalia, it will be ranked fifty-three in Africa.\nhmde | The next task is to show the bottom twenty percent of the countries. Showing the top twenty percent would not add much value since the measure cannot exceed one hundred percent of the population. In order to do this, we created a new calculated field called Percentile Filter, and told Tableau that we want to know whether the percentile of each country is less than two tenths. This means that it's in the bottom twenty percent of all the countries in its partition. Then, define the partition. The default is that the entire table is the partition, but we want each pane to be the partition.\nxqay | The filter shown in the following screenshot has three possible results, namely true, false, and null, which makes it a Boolean field that shows up with a T F icon in the data window. Since we excluded the nulls, we will not get null values:\n0h1s | Chapter six\nhdzg | In order to make sure that the total ranking of the countries in each region and showing only the bottom twenty percent, perform the following steps:\nz5v5 | One. Click on Default Table Calculation.\nm4v9 | Two. Select Country.\nqwpz | Three. Click on OK.\nhd4a | Four. Click on OK again.\nm7uf | Five. Drag the field to the Filters shelf.\nq5qw | Six. Select TRUE.\no3yk | You can also allow users to see the percentage of their preference by creating a parameter with a data type of float and a rank from zero to one point zero zero that replaces the hard-coded zero point two in the formula, as shown in previous screenshot.\nkulu | There are several functions within Tableau Public for ranking, and except for RANK_PERCENTILE, the other functions vary only in the way they use unique or duplicate ranking values.\n195s | Window versus running functions\nmgpm | We have briefly discussed the WINDOW functions already. There's also another type of function, called the RUNNING function. The WINDOW functions have specific partitions, that is, they measure either the whole table, pane, or cell, or from a specific number of previous or future values. Alternatively, the RUNNING function compares all the values before the current value in the partition.\nky35 | Level of Detail and Table Calculations\n96hq | In the following example, we graphed the average percentage of the GDP that was from high-tech exports by region and by year in the World Development Indicators data source. This is a simple spark bar graph. We have hidden the header for the y axis in this graph.\n9tvh | We created a calculated field that, for each year, tests whether the average High Tech Exports as a percentage of the GDP is equal to the running maximum, that is, is the value for any year higher than all the years before it. The results are true and false, as shown in the following screenshot:\nulcl | The RUNNING MAX function, which is one of several RUNNING functions, does not have the start and end offsets like the WINDOW functions. However, you still need to address it.\n84ys | A note on addressing\n1mjq | The following table calculation computes across the pane. You can also set it to Compute using Year. Year is the field along the x axis. Addressing the table calculation across the pane tells it to compute across the x axis and then to use other fields on the visualization, such as Region, as the partition or group. So, this field is addressed across year, and the calculation is performed for each Region.\nrplz | Add the Region field to the Color shelf in the visualization and then format the true values so that they are blue, and format the false values so that they are orange, as shown in the following screenshot:\n27ge | Chapter six\njgcj | The level of detail calculations\n88ni | The level of detail calculations enable you to tell Tableau Public at exactly\nid8b | which dimensional level you would like to aggregate without having to place that dimension on the visualization. Additionally, you can include or exclude dimensions in the calculations and create calculations that include all the underlying data.\n2mmu | Level of Detail and Table Calculations",
        "role": "assistant",
        "function_call": null,
        "tool_calls": null,
        "refusal": null
      }
    }
  ],
  "created": 1725394554,
  "model": "gpt-4o-2024-05-13",
  "object": "chat.completion",
  "system_fingerprint": "fp_fde2829a40",
  "usage": {
    "completion_tokens": 1812,
    "prompt_tokens": 3516,
    "total_tokens": 5328
  }
}