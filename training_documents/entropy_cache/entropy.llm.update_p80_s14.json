{
  "id": "chatcmpl-A0ZgX8fjfFXGjVHeQBtkHVRJqgB0k",
  "choices": [
    {
      "finish_reason": "stop",
      "index": 0,
      "logprobs": null,
      "message": {
        "content": "```\n3jlo | Thus, in thermal equilibrium we can think of entropy as k times the log of the number of accessible states, 'corrected' so that the result doesn't change when we add a constant to the energy of every state.\nldqe | THE POWER OF THE PARTITION FUNCTION\nqt5x | A classical harmonic oscillator with mass m and spring constant k has energy\ncc6l | p, q) = twelve plus K g squared over two m.\nw8g7 | K g squared.\n0lyq | Its partition function is\nmk88 | d p d q h.\nkft0 | Z beta equals the integral from zero to infinity of e to the negative beta E of p,q.\nafqg | where beta is coolness and h is Planck's constant.\nvz07 | From this we can find its expected energy and free energy in thermal equilibrium:\n8wou | F equals negative one times the natural log of Z.\n6x7z | The expected value of E equals negative the partial derivative of the natural log of Z with respect to beta.\n1q42 | and then its entropy:\n5ycu | S equals the expected value of E minus F over T where T is temperature: beta equals one over k T where k is Boltzmann's constant.\nlhe0 | To test the power of the partition function, let's use it to figure out the entropy of a classical harmonic oscillator. Here's the game plan. First we'll compute the partition function by doing the integral in bright red. Then we'll use it to compute the oscillator's expected energy and free energy. Then we'll subtract those and divide by temperature to get the entropy.\narcp | In fact, we've already worked out the answer to this problem:\n8wsg | S equals k times the natural log of beta h over two pi T plus one.\nm65y | Our earlier approach led to some cool insights. But it was 'tricky', not systematic. The partition function method is systematic, so it's good for harder problems. It will also give new insight into that pesky plus one.\nm652 | When we compute the entropy using a partition function, all the pain is concentrated at one point: computing the partition function! So let's get that over with.\n00j4 | HARMONIC OSCILLATOR: PARTITION FUNCTION\nfkpa | A classical harmonic oscillator has energy E(p, q) equals p squared plus k g squared over two and frequency omega equals the square root of K over m, so its partition function is\n7ovw | V m equals the square root of m.\n7h0s | the integral from zero to infinity of e to the negative beta r squared over two r d r d theta.\n7cdl | (switching to polar)\n8mej | u equals r squared over two.\nmlec | equals one over beta h omega.\nllys | The partition function equals one over beta h omega.\nrmu5 | Z beta equals one over beta h omega.\n3o98 | beta h omega.\nzd6z | For the harmonic oscillator, the partition function is the integral of a Gaussian in two variables. A change of variables makes the Gaussian 'round', and then we use polar coordinates to do the integral.\nk1a2 | The physicist Kelvin is said to have written\nnlu6 | The integral from negative infinity to infinity of e to the negative x squared d x equals the square root of pi.\nsiqn | on the blackboard and said \"A mathematician is one to whom that is as obvious as that twice two makes four is to you.\" I find that rather obnoxious, but when I heard the story as a kid, I made damn sure I knew how to do this integral. The usual trick is to compute the square of this integral using polar coordinates.\n2ae7 | Now we're seeing something interesting. The harmonic oscillator, whose energy depends quadratically on two degrees of freedom, is physically more important than a system whose energy depends quadratically on just one degree of freedom. And when beta equals h equals omega equals one, the partition function of the harmonic oscillator is\nu9wd | the integral from negative infinity to infinity of e to the negative x squared d x d y equals the integral from zero to infinity of r times e to the negative r squared over two d r d theta equals two pi times one over two equals pi.\n6i0o | which is more fundamental than the integral Kelvin wrote down.\n54u3 | HARMONIC OSCILLATOR: EXPECTED ENERGY\n1x9z | A classical harmonic oscillator has partition function\n4235 | Z equals beta h omega.\n8xlb | so its expected energy in thermal equilibrium is\nj21f | The expected value of E equals negative the partial derivative of the natural log of Z with respect to beta.\njftb | The expected value of E equals k T.\ngj9e | just as the equipartition theorem says it must be!\n12a1 | Once we know the partition function of the classical harmonic oscillator, it's easy to compute its expected energy: just use\nucuv | The expected value of E equals negative the partial derivative of the natural log of Z with respect to beta.\n2tn9 | and get\n0g39 | The expected value of E equals negative the partial derivative of the natural log of beta h omega with respect to beta.\n3qn6 | beta equals one over k T.\n65yq | We can also figure this out using the equipartition theorem. Remember, the equipartition theorem applies to a classical system whose energy is quadratic. If it has n degrees of freedom, then at temperature T it has\np4rq | The expected value of E equals k T.\n33o8 | Our harmonic oscillator has n equals two, so we get the expected value of E equals k T. Good, this matches the partition function approach!\nfopo | HARMONIC OSCILLATOR: FREE ENERGY\nb12h | A classical harmonic oscillator has partition function\nvk7m | Z beta equals one over beta h omega.\n39f8 | so its free energy in thermal equilibrium is\nupcg | F equals negative the natural log of Z equals negative the natural log of one over beta h omega\nqzb9 | F equals negative k T natural log of beta h omega.\nacan | equals one over beta h omega.\nj623 | The partition function lets us do more! It lets us compute the free energy, too, using\nd7ly | F equals negative k T natural log of Z.\nplf9 | Unlike the expected energy, the free energy involves Planck's constant:\nvk11 | F equals negative k T natural log of beta h omega.\njj0l | Note k T and h omega both have units of energy, so k T over h omega is dimensionless, which is good because we're taking its logarithm. Also note that the free energy is negative at high temperatures! That may seem weird, but it turns out to be good when we compute the entropy.\nqdqt | HARMONIC OSCILLATOR: ENTROPY\n6h7m | In thermal equilibrium at temperature T, a classical harmonic oscillator has\nb6vb | k T over h omega so its entropy is\nc5h2 | expected energy E equals k T and free energy F equals negative k T natural log of beta h omega.\neccu | k T over h omega.\nrtpq | negative\npo9y | k T plus k T natural log T.\nw5lk | S equals the expected value of E minus F over T.\npb48 | k T\nnriw | plus one\nh7kb | over h omega.\n2mrs | To compute the entropy of a classical harmonic oscillator, we just use\nf7it | S equals the expected value of E minus F over T.\no9jm | We get the answer we got before, of course:\ngz4c | S equals k natural log of beta h over two pi T plus one.\nu30w | But now we can finally understand the puzzling extra plus one.\nee2o | As we've seen, the entropy of any system in thermal equilibrium consists of two parts:\np87c | One. The free energy part, negative F over T. For the classical harmonic oscillator this is\nreyp | Two. The expected energy part, the expected value of E over T. For the classical harmonic oscillator this is\n9vu6 | the expected value of E over T.\nli13 | k.\nyb5z | The free energy part of the entropy is always k times the logarithm of the number of accessible states. For the classical harmonic oscillator, the expected energy part of the entropy must equal k by the equipartition theorem, since the oscillator's energy depends on two degrees of freedom. This is small compared to the free energy part when h omega is less than k T: that is, when quantum effects are small compared to thermal effects.\nl7da | PARTICLE IN A BOX: PARTITION FUNCTION\n24j5 | The energy of a classical free particle of mass m in a one-dimensional box depends only on its momentum p:\nsyjc | p squared over two m.\nijx9 | Its position q is trapped in the interval zero to L.\nsosd | Its partition function is therefore\nzxxx | Z beta equals the integral from negative infinity to infinity of e to the negative beta E of p,q d p d q over h.\ne6pm | The integral from negative infinity to infinity of e to the negative beta p squared over two m d p equals\nml6c | two pi m over beta.\nujdt | beta.\numn7 | Now let's turn to our ultimate goal: computing the entropy of a box of gas. As a warmup, let's figure out the entropy of a single particle in a box. In fact, let's start with a free classical particle in a one-dimensional box: that is, in some interval zero to L.\nt2yx | The first step is to compute its partition function. As you can see, this is easy enough. But the whole idea raises some questions. Some people get freaked out by the concept of entropy for a single particle I guess because it involves probability theory for a single particle, and they think probability only applies to large numbers of things.\n70qq | I sometimes ask these people \"how large counts as large?\" In fact the foundations of probability theory are just as mysterious for large numbers of things as for just one thing. What do probabilities really mean? We could argue about this all day: Bayesian versus frequentist interpretations of probability, etc. I said a tiny bit about this before, and I won't say more now.\n2421 | Large numbers of things tend to make large deviations less likely. For example, the chance of having all the gas atoms in a box all on the left side is less if you have one thousand atoms than if you have just two. This makes us worry less about using averages and probability.\n```",
        "role": "assistant",
        "function_call": null,
        "tool_calls": null,
        "refusal": null
      }
    }
  ],
  "created": 1724700537,
  "model": "gpt-4o-2024-05-13",
  "object": "chat.completion",
  "system_fingerprint": "fp_a2ff031fb5",
  "usage": {
    "completion_tokens": 2267,
    "prompt_tokens": 3751,
    "total_tokens": 6018
  }
}