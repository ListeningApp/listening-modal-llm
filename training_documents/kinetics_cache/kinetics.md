## Genome-wide inference reveals that feedback regulations constrain promoter-dependent transcriptional burst kinetics

ABSTRACT

Gene expression in mammalian cells is highly variable and episodic, resulting in a series of discontinu- uous bursts of mRNAs. A challenge is to understand how static promoter architecture and dynamic feedback regulations dictate bursting on a genome-wide scale. Although single-cell RNA sequencing provides an opportunity to address this challenge, effective analytical methods are scarce. We developed an interpretable and scalable inference framework, which combined experimental data with a mechanistic model to infer transcriptional burst kinetics (sizes and frequencies) and feedback regulations. Applying this framework to single-cell RNA sequencing data generated from embryonic mouse fibroblast cells, we found Simpson's paradoxes, i.e. genome-wide burst kinetics exhibit different characteristics in two cases without and with distinguishing feedback regulations. We also showed that feedbacks differently modulate burst frequencies and sizes and conceal the effects of transcription start site distributions on burst kinetics. Notably, only in the presence of positive feedback, TATA genes are expressed with high burst frequencies and enhancer-promoter interactions mainly modulate burst frequencies. The developed inference method provided a flexible and efficient way to investigate transcriptional burst kinetics and the obtained results would be helpful for understanding cell development and fate decision.


## INTRODUCTION

The gene-expression variability resulting from programmed and stochastic processes has emerged as a central preoccupation for investigating gene regulation. Genes are stochastically transcribed often in a discontinuous bursting manner. Transcriptional bursting is regarded as a primary proxy of stochasticity in gene expression and contributes to cell-to-cell variability, but the molecular mechanisms governing transcriptional bursting kinetics still remain elusive. Many experimental studies have provided evidence for linking static promoter architecture and sequence to transcriptional bursting and, therefore, to the resulting variability in gene expression. This variability can propagate from mRNA to protein and further to the downstream target genes via a complex regulatory network. This raises important issues: On the genome-wide scale, how do static promoter regulatory sequences encode transcriptional burst kinetics, and how do dynamic gene regulatory networks shape burst kinetics?

An intuitive view is that there is an indispensable link of gene-expression variability to promoter architecture. This link is due to the fact that a basic step of RNA synthesis is to copy the genetic information from the gene promoter. Much effort has been devoted to rationalizing the promoter-architecture encoding of transcriptional burst kinetics on genome-wide scales. For example, genes with TATA boxes increase variability in expression levels, whereas the presence of C-P-G island significantly lowers the variability. The sharp distributions of transcription start sites lead to higher gene-expression variability than the broad transcription start sites distributions. A recent study has revealed that the increases in burst sizes are dependent on the presence of TATA box and initiator elements (characteristics of the core promoter), and burst frequencies are regulated by enhancer-promoter interactions. All these studies and others indicate the importance of promoter architecture in modulating transcriptional burst kinetics.

Another viewpoint is that feedback regulations modulate transcriptional burst kinetics by creating a higher-level structure regulatory pattern. In fact, feedback regulations exist extensively in biological systems, and their functions may be reflected by the circuits of interacting genes and proteins. In particular, auto-regulatory feedback loops have been identified in various regulatory systems, where transcription factors directly or indirectly regulate the corresponding gene expression. In general, feedbacks can be categorized into positive and negative ones. Experimental investigations for a few genes or transcripts have demonstrated that different kinds of feedback played diverse roles. For example, negative feedback limits large expression variability and accelerates responses. Conversely, positive feedback amplifies expression variation, induces bimodal expression, and stimulates genes to 'active' states. In addition, negative feedback with a long delay loop can display increased variability. Theoretical analysis has also shown that different feedback mechanisms modulate burst kinetics in different manners. All these studies indicate the important roles of feedback regulations in mediating gene expression, including transcriptional bursts, but it is unclear whether the results obtained for case-by-case studies can hold on a genome-wide scale.

The above two viewpoints are not solitary but are complementary to each other. A challenging task is to investigate how static promoter architecture and dynamic feedback regulation coordinate transcriptional burst kinetics on a genome-wide scale. Previous studies of transcriptional bursting were limited to low-throughput experimental approaches, where observed experimental results could not be generalized across different genes or cell types. Recently, single-cell RNA sequencing has enabled the in-depth measurement of expression levels within cell populations, providing an opportunity to study genome-wide transcriptional mechanisms. An important step toward this study is to develop mathematical models for the genome-wide inference of burst kinetics. The models for inference should satisfy some requirements. First, these models should be interpretable, i.e. they can capture essential gene-expression dynamics and convey kinetic information about transcriptional bursts. Previous studies relied on inferring the direct correlations between features across molecular scales. However, these correlations are insufficient to uncover the mechanisms of gene expression. Second, the inference models should be tractable, i.e. they can effectively treat a large number of cells and genes. In general, a complex mechanistic model incorporating regulatory factors is difficult to analyze on the one hand, and a genome-wide inference needs expensive computational cost on the other hand. Therefore, an interpretable and tractable inference framework integrating experimental data and molecular mechanisms is strongly demanded.

Here we developed a statistical framework based on the model-driven and data-driven combination to perform a scalable genome-wide inference. This framework used the static snapshots of single-cell RNA sequencing data to infer the regulatory mechanisms underlying transcriptional burst kinetics. Specifically, it integrated the expected information on gene-expression variability, burst frequencies, burst sizes, and feedback regulation forms. Applying this inference method to the single-cell RNA sequencing data generated from embryonic mouse fibroblast cells, we showed that feedbacks differently modulate burst frequencies and sizes, TATA genes are expressed with high burst frequencies only in the presence of positive feedback, feedback regulations conceal the effects of transcription start site distribution on transcriptional burst kinetics, and enhancer-promoter interactions mainly modulate burst frequencies only in the presence of positive feedbacks. Briefly, we found that characteristics of genome-wide transcriptional burst kinetics in the case without feedback regulations were different from those in the case with feedback regulations, implying Simpson's Paradox, an interesting statistical phenomenon.


## MATERIALS AND METHODS

A mechanistic hierarchic model for statistical inference

The observed counts in a single-cell RNA sequencing experiment reflect a combination of the true expression level and the measurement level of each gene in each cell. We describe the observed counts by a two-level hierarchical model (See details in Supplementary Text one point one, Figure one d, and Supplementary Figure S one a-c):

P(Y = y) = integral P meas (y |n) P gene (n) dn where P meas of y given n is for a measurement model and P gene of n for a gene expression model.

The first level represents the measurement process for the observed count Yeg conditional on the true expression level Neg of gene g in cell c, with a conditional probability distribution:

Ycg given Neg follows Pmeas of y given n.

The Pmeas of y given n describes all aspects of the technical noise produced in the measurement process for a given true expression level Neg, and is suggested as a Binomial distribution or Poisson distribution which is supported by empirical analyses and theoretical arguments in many existing methods. By adding an extra sampling probability Àcg in the sequencing process, we characterize the sequencing depth and assume that intercellular molecules are independent of each other and only the proportional products are captured and sequenced using Binomial distribution

Ycg given Neg follows Binomial of n, Àcg.

In our calculations, we set the sampling probability Àcg equals zero point five without loss of generality since the setting of Àcg does not influence our qualitative results.

The second level is the true expression level of gene g across cells, which is assumed to follow a probability distribution

Neg follows Pgene of n.

The underlying model describes the intrinsic dynamics of stochastic gene expression. How an appropriate gene-expression model Pgene of n is chosen is critical. In general, this choice needs to satisfy two basic requirements: (i) the model should capture the essential gene-expression dynamics of interest (e.g. transcriptional burst kinetics); and (ii) the inference based on the model should be effective and scalable to large numbers of cells and genes. As combining mechanistic models to infer the entire gene regulatory network would lead to sophisticated models that become intractable, we simplified the gene regulatory network to a feedback loop, which is the most common form existing in gene expression systems. For these purposes, we adopt a model of stochastic gene expression, which simultaneously characterizes transcriptional burst kinetics and auto-regulatory feedbacks with the below distribution

Pgene of n equals N N

zero to infinity Poisson of n given x x raised to the power of a times one plus e minus one e to the power of negative x over b one plus the fraction of x over k closes the bracket raised to the power of a all over dx,

where N is a normalization factor. Note that the discrete gene expression distribution is a Poisson representation in form, i.e. Pgene of n equals Poisson of n given x f of x dx, where f of x is a kernel density function that has the same form as the continuous distribution of proteins. As illustrated in Figure one B, this kernel function f of x can extract several kinetic parameters, denoted by θ equals a, b, c, k, h, of the steady-state gene-product distribution from a dynamic model with auto-regulatory feedback described by some meaningful kinetic parameters: switching rates between inactive and active state kon, koff, mRNA transcription rates Ksyn and degradation rates kdeg. Here, a is the number of bursts per cell cycle (burst frequency), and b is the mean number of gene products generated per burst (burst size), and h is a vital parameter of capturing the feedback regulation dynamics of gene products, which is actually a Hill coefficient. Furthermore, this model can describe two most common feedback loops in gene expression: positive-feedback loop (i.e. h less than zero) and negative feedback loop (i.e. h greater than zero). It should be noted that the auto-regulatory feedbacks involve gene products, which directly or indirectly regulate the corresponding target gene itself through feedback loops, resulting in a repressing or activating expression. The small leakiness proportion of the promoter contains the information on the baseline bursts in the absence of regulation, and k contains the information on the equilibrium binding constant. Overall, Equation is a mechanistic model, which can simultaneously describe the burst-production and feedback-regulation processes of gene expression. More importantly, as a special case of this model, h equals zero corresponds to the negative binomial distribution of gene expression Pgene of n (i.e. non-feedback).

By combining Equations and and substituting into Equation, the discrete probability distribution of Yeg can be computed but is expressed in an integral form:

P of Y equals y equals integral from zero to infinity of Pmeas of y given n Pgene of n dn equals integral from zero to infinity Poisson of Y equals y given x f of x dx equals N integral from zero to infinity x raised to the power of a times one plus e minus one e to the power of negative x over b one plus the fraction of x over k closes the bracket raised to the power of a all over y factorial dx.

For the case of non-feedback, we employ the negative binomial distribution, which is then given by equals y equals the integral of a raised to the power of v times e raised to the power of negative x times the fraction of one over x all raised to the power of y, a divided by the quantity a minus one factorial, times x raised to the power of a minus one e to the power of negative x over b dx, where Gamma is the Gamma function.

Maximum likelihood estimation of parameters

Here we introduce a method of estimating the kinetic parameters in our hierarchical model using the expression data of each gene. For a given expression read of observed cells, the most common parameter estimation method is the maximum likelihood estimation, which can be formulated as the following optimization problem of five parameters θ equals a, b, c, k, h in our case arg min of negative L of y given θ equals arg min of theta negative ln of P of Y equals y given theta,

Because of the complex integral and unnormalized probability mass function in Equation, calculating the integral directly through the M C M C method would be at a high cost of computation, and in particular, it is hard to use in the analysis of genome-wide data. Therefore, we apply the Generalized Gauss-Laguerre Quadrature Rules to Equation instead of the use of the M C M C method, realizing a rapid calculation in inference:

P of Y equals y given θ equals N the fraction of x raised to the power of a times one plus e minus one e to the power of negative x over b one plus the fraction of x over k dx zero to infinity where x i, w i can be determined by the generalized Laguerre polynomials.

In particular, a simple algebraic transformation in Equation seven yields the explicit expression of the probability distribution in the case of non-feedback:

P(Y equals y ;- ) equals one hundred (x)" y! o-lambda chi bar (a) one x a-le-x/b dx equals (a plus y) Beta (a, y plus one) (b) plus one)/ plus a' (bx) y where Beta is the Beta function.


## Optimization method and initial values setting

To realize a fast calculation for solving the optimization problem (Equation eight) of parameter estimation, we use the f min con function in the LBFGS method of M A T L A B, a nonlinear programming solver, to find the minimum of the optimization problem given a set of initial values and parameter intervals a equals (ten to the power of negative one, thirty), b equals (one, twenty), k equals (one, one thousand three), h equals (negative ten, negative one) or (one, ten). For each gene and each case of positive, negative, and non-feedbacks, we repeatedly solve the optimization problem thirty times.

We restrict that the initial values of the optimization problem obey the following rules. First, we consider initial points of a (burst frequency) and b (burst size). Here X is a random variable of the distribution in Equation five. Since Gamma distribution is a special case of Equation five, we assume that the initial points a and b follow

E left[ X right] equals a b, Var left[ X right] equals a b squared.

On the other hand, by considering the initial values of Y generated by our hierarchical model, we have

E left[ Y right] equals E left[ E left[ Y given X right] right] equals lambda E left[ X right] equals lambda a b , Var left[ Y right] equals E left[ Var left[ Y given X right] right] plus Var left[ E left[ Y given X right] right] equals lambda a b plus lambda squared a b squared.

Given the expectation and variance of Y, we can in return estimate burst frequency a and burst size b by rearranging Equations twelve and thirteen, which are then taken as initial values a equals fraction left[ E left[ Y right] squared right] over left[ Var left[ Y right] minus E left[ Y right] right] , b equals left( fraction left[ Var left[ Y right] right] over left[ E left[ Y right] right] minus one right) over lambda

Usually, the transcriptional rate in the OFF state is much smaller than that in the ON state. And a small enough leaky rate does not affect the distribution shape of gene expression. Therefore, we fix & at the constant of zero point zero five during our inference. The h value is extracted from a uniform distribution between the integer negative five and negative one (positive feedback) or integers one and five (negative feedback). And the values of parameter k are extracted from the log-uniform (logarithm base ten) distribution on interval left[ zero , two right] . Model selection

Using the above inference method, we obtain ninety inferred results for each case of positive, negative, and non-feedbacks. Then, we filter out the unreliable results on the inference boundary, which are possibly caused by the optimization program setting. On this basis, we compute the value of the corrected Akaike information criterion and select the best model corresponding to the smallest AICc,

A I C c equals negative two log L left( widehat theta right) plus two k plus fraction two k left( k plus one right) over n minus k minus one,

where the maximum likelihood L left( widehat theta right) is the result during the inference run, k is the number of model parameters, and n is the sample size of observed data.


## Validation on synthetic sc R N A-sequencing data

In order to check whether the above statistical inference method can effectively infer burst frequency, burst size, and feedback form in our hierarchical model, we produce synthetic single-cell R N A data. Given a set of model parameter values theta equals left( a , b , epsilon , k , h right) , we first calculate the probability distributions of these parameters according to the method described in the above section and then carry out random samples according to the probability of each parameter value to obtain the input data for the inference process.

We show the precision regions for the inference of burst kinetics (burst frequencies and burst sizes) under different feedback strengths H and different equilibrium binding constants K. And the error between true parameters theta true equals the ordered pair Bf true and Bs true and estimated parameters theta est equals the ordered pair Bf est and Bs est is calculated according to:

Error ordered pair theta true and theta est equals the sum of open parenthesis logarithm of Bf true minus logarithm of Bf est close parenthesis squared plus open parenthesis logarithm of Bs true minus logarithm of Bs est close parenthesis squared.

We show the robustness of the inference in the cases of positive, negative, and non-feedbacks, respectively. To explore the robustness of the cell numbers to the inference, we select different sampled cell numbers (two hundred, three hundred, five hundred, one thousand, five thousand) to synthesize data fifty times, and at each time, set thirty different initial points for optimization in each case of feedback forms. The optimization process is the same as the inference process of real data. The same process is used to explore the effects of stochastic losses of mRNA molecules (sensitivity), missing randomly at a certain probability (zero point one, zero point three, zero point five, zero point seven or zero point nine) from sufficient samples (number equals two thousand). The results of inference robustness analysis are illustrated with two different distribution examples in the three cases of feedback forms.


## Inference evaluation

To assess whether the observed data came from the distribution generated via the parameters inferred by our method, we use goodness-of-fit statistics that obey chi-square distribution of large samples:

Chi-square equals the sum from k equals zero to infinity of the fraction open parenthesis Ok minus Ek close parenthesis squared over Ek,

where Ok is the observed sample number whose mRNA number is k, and Ek is the expected sample number. Note that in some sequencing techniques, the cell samples of scRNA-seq data are not large enough, so it is needed to use the Monte Carlo method to generate the null distribution of chi-square goodness-of-fit test instead of the asymptotic distribution. For each gene, we first generate the same number of samples as that in the observed data from the probability of each point with the inferred parameters and then compute the chi-square sim statistic according to Equation seventeen. After repeating the Monte Carlo simulation procedure for one thousand times, we judge whether the resulting inference is a good fit by comparing X obs squared with the resulting one thousand chi-square sim. The criterion that an inferred parameter is a good fit is that the X obs squared is at least less than five percentage numbers of chi-square sim.


## Data analysis

scRNA-seq data processing. We utilize the processed scRNA-seq data for ten thousand seven hundred twenty-seven genes of transcriptomes from two hundred twenty-four individual mouse embryonic fibroblasts for each allele (C fifty-seven cross CAST). In that paper, the quantification of gene transcription is based on the Smart-seq two scRNA-seq libraries, and UMI counts is used to reduce the amplification noise. To ensure that the inference process is not hindered by low-quality elements of the data as far as possible, we carry out a certain degree of quality control of the original data. We filter out the genes expressed in less than fifty cells. Also, we filter out the cells expressed in less than two thousand genes. In addition, we filter out the genes whose overall average expression levels are less than two. After these manipulations on each allelic data (C fifty-seven cross CAST), the genes that meet the conditions are combined to facilitate inferences from more adequate samples and give a single-cell expression matrix composed of two thousand one hundred sixty-two genes and four hundred thirteen cells. This treatment is based on the assumption that the distributions of almost all genes for the CAST and c fifty-seven alleles have similar shapes and that the transcriptional dynamic behavior is consistent between alleles for most genes, which is also supported by previous studies. And, we removed the outlier data with the tail five percent of the distribution. In addition, our method can be also applied to any high-quality non-allelic scRNA-seq data.

Identification of promoter motif and T S S distribution. The recognition and coordinates of the promoter motifs, T A T A box, Initiator, C C A A T box, G C box, are downloaded from the Select/Download Tool of the E P D New database. In order to determine the T S S distribution of mouse embryonic fibroblasts, M E Fs FANTOM five Cap Analysis of gene expression data is retrieved through the CAGEr R package. After normalization and T S S clustering, T S S distribution is defined as sharp if the promoter width is less than fifteen base pairs, this length is taken as the median of all genes, and as broad otherwise.

Identification of enhancer-promoter intensity. The data about the interaction between enhancer and promoter is downloaded. The dataset is used to compare the correlation between burst kinetics and enhancer activity of fibroblasts and M ESCs. Enhancer activity is calculated according to the intensity of the H three K twenty-seven acetylation peak measured in the defined E P Us region, which is considered that enhancer and promoter interactions occur more possibly, via CHIP sequencing in a previous study. In our study, we only utilize the collated data that includes the peak of H three K twenty-seven acetylation in E P Us of M E Fs.


## Statistical analysis

Gene expression variability. Gene expression variability is usually quantified by the square of the coefficient of variation, C V squared, which is defined as the ratio of the variance over the square of the mean. According to this definition, we calculate gene-expression variability in a given set of observed data Y for gene G. Similarly, we use the inferred estimate to calculate the theoretical C V squared of our hierarchical model for gene G, that is,

C V squared E of open square bracket Y semicolon estimate close square bracket squared Variance open square bracket Y semicolon estimate close square bracket

When fitting C V squared with a cubic spline, we find that there is a strong correlation between the mean expression level and

When fitting CV2 with a cubic spline, we find that there is a strong correlation between the mean expression level and

C V squared. Many studies have discussed the relationship between gene-expression variability and mean. Note that in the classical telegraph model, the total mRNA variability can be decomposed into two parts: the mRNA internal variability generated from transcription and the promoter variability due to the switching between active and inactive states. Inspired, we adjust the variability by subtracting the inverse of the logarithmic mean, logarithm base two, thus obtaining the residual squared coefficient of variation, rC V squared. For example, for gene G, we have rC V squared equals C V squared logarithm base two of mu subscript G minus one where mu subscript G equals E of open bracket Y semicolon estimate close bracket. As a result, the influence of the mean expression level on the expression variability is basically eliminated after performing a linear regression on rC V squared.

Linear regression model in promoter motif analysis. After having obtained the promoter motifs of each gene from the E P D database and its burst kinetics, rC V squared, burst frequency, burst size, by inference, we conduct multivariate linear regression with interaction terms to find the correlations between quantities of interest in cases of positive, negative, and non-feedbacks. Specifically, we perform multivariate linear regression according to

Linear regression model in promoter motif analysis. After having obtained the promoter motifs of each gene from the EPD database and its burst kinetics (rCV2, burst fre- quency, burst size) by inference, we conduct multivariate linear regression with interaction terms to find the corre- lations between quantities of interest in cases of positive, negative, and non-feedbacks. Specifically, we perform mul- tivariate linear regression according to rC V squared is approximately equal to open bracket T A T A multiplied by Initiator plus C C A A T multiplied by G C close bracket times feedback,

logarithm base ten of burst frequency is approximately equal to open bracket T A T A multiplied by Initiator plus C C A A T multiplied by G C close bracket times feedback, logarithm base ten of burst size is approximately equal to open bracket T A T A multiplied by Initiator plus C C A A T multiplied by G C close bracket times feedback.

In Figure four B through D and Supplementary Figure S ten c through e, we show the t-value in the regression results. The absolute of t-value is larger in the test of the linear regression coefficient, indicating that the resulting correlations are significant.


## RESULTS

An integrated statistical framework for learning promoter-dependent yet feedback-constrained transcriptional burst kinetics on a genome-wide scale

Cell-to-cell heterogeneity in gene expression is primarily attributed to transcriptional bursting, which is represented by a vector y of components including burst frequency, burst size, expression variability, etc. Transcriptional bursts result from complex molecular processes on multilayered sources, which are represented by a vector x of components including static D N A sequences, epigenetic modifications, transcription, translation, dynamic network regulations, etc. Then, the question of how these molecular processes coordinate transcriptional bursting can be mathematically described as y equals f of open bracket x close bracket, where f is a vector function describing the correlation of x to y.

Static promoter architecture is an essential D N A sequence for binding transcription factors during mRNA synthesis. Specifically, promoter motifs, such as initiator, T A T A box, C C A A T box, G C box, broad and sharp T S S

distributions, and enhancer-promoter interactions are essential features of eukaryotic promoter architecture. Meanwhile, variability in gene expression can propagate from mRNA to protein and further to target genes, possibly through a dynamic and complex gene regulatory network. A common form of dynamic regulation is auto-regulation which directly or indirectly regulates the corresponding target gene itself through a feedback loop, resulting in a repressing or activating expression. For clarity, we let vectors x one and x two represent static promoter architecture and dynamic feedback regulation, respectively. The information on promoter architecture, x one, can be recovered from public bioinformatics databases such as the E P D database, Bioconductor, and U C S C Genome Browser. In general, the mechanisms of dynamic regulation, x two, and burst kinetics, y, are not directly measurable but hidden in data sets. Unlike some imaging-based technologies such as M S two system that were limited to a few genes and could not be extended to the whole genome, single-cell sequencing technologies made it possible to recover the information on dynamic regulations, x two, and burst kinetics, y, from static snapshots. Figure one B through E summarizes the genome-wide inference procedure proposed here. This procedure used a statistical framework of the model-driven and data-driven combination to infer dynamic feedback regulations and transcriptional burst kinetics from static sc R N A sequencing data under the assumption that the abundances of mRNA and protein were highly dependent.

Specifically, our statistical inference framework used a mechanistic model of gene expression, which simultaneously considered transcriptional burst kinetics, y, and feedback regulations, x two, to obtain true gene expression distributions. On the other hand, the known sc R N A sequencing data gave observed gene expression distributions, implying possible errors in the sequencing technologies. A hierarchical statistical model, see Materials and Methods, was proposed to link true gene-expression levels and observed mRNA counts, thus determining key kinetic parameters, expression variability, burst size, burst frequency, and dynamic regulation. We emphasized that the proposed framework was a scalable genome-wide inference, which was particularly useful in revealing how both static promoter architecture and dynamic feedback regulation coordinate transcriptional bursting.

A hierarchical model provides the genome-wide inference of transcriptional burst kinetics and feedback regulations from single-cell snapshots

The hierarchical statistical model developed here can give a mechanistic interpretation for Unique Molecular Identifiers based on single-cell RNA sequencing data. In fact, this model not only captured the characteristics of transcriptional burst kinetics and feedback regulations, but also described the measured noise of Unique Molecular Identifiers data (see 'Materials and Methods'). Then, we used the maximum likelihood method to determine burst kinetics and feedback forms (positive-, negative-, non-feedback) within biologically reasonable ranges of model parameters. Note that the inferences with traditional Markov Chain Monte Carlo methods would need huge and even unaffordable computational costs since the static messenger RNA distribution was expressed in a high-order integral that is difficult to solve. To overcome this difficulty, we developed a fast algorithm for computing this distribution based on generalized Gauss-Laguerre quadrature rules, thus realizing a scalable genome-wide inference (see 'Materials and Methods').

To evaluate the validity of our inference method, we first explored the sensitivity of distribution shapes to changes in model parameters. We found that the genes with high expression levels were more sensitive to model parameters than the other genes. Then, to test the reliability of the method in inferring kinetic parameters, we generated synthetic single-cell RNA data by stochastic sampling from the distribution for the hierarchical model with known parameter values. Through inference using the synthetic data, we can give robust estimates of burst frequencies, burst sizes, and feedback forms from the corresponding static messenger RNA distributions. Besides, we also assessed the robustness of our inference method to different cell numbers and stochastic losses of messenger RNA molecules (mimicking the incomplete messenger RNA detection in single-cell RNA sequencing protocols). Overall, we provided a mechanistic model and an effective, robust and scalable inference method for learning dynamic burst kinetics and feedback forms from static snapshot data, which can be conveniently used in the analysis of single-cell RNA sequencing data.

Next, we applied our hierarchical model and inference approach to the single-cell RNA sequencing data of primary mouse fibroblasts. From the original Unique Molecular Identifiers data containing ten thousand seven hundred twenty-seven genes and two hundred twenty-four cells, we selected two thousand one hundred sixty-two highly expressed genes using a quality control method and then merged two allelic expression data into a matrix to infer burst kinetics and feedback forms. We observed that these selected genes were transcribed with widely different burst kinetics, and in particular, those genes with the same average expression level exhibited diverse burst kinetics, implying that the expressions of different genes were regulated possibly by different molecular mechanisms. To check the validity of these inferred results, we performed a goodness-of-fit test (see 'Materials and Methods'). We found that the distributions from the dataset were consistent with those obtained using the inferred parameters.

ure S7a), and confirmed that the messenger RNA mean and variability in the mechanistic model matched those in the data. All the good-fit genes can be classified into three categories: six hundred twenty-six positive-feedback genes, six hundred twenty-five negative-feedback genes, and eight hundred forty non-feedback genes. The inferred results for example genes: Mbnl two, Prr thirteen, Ralb, and Plod one were demonstrated in Figure two a one-a four, showing that these genes had different feedback forms and followed different distributions. Interestingly, our hierarchical model can particularly recover bimodal distributions from static data, which however were fitted as unimodal distributions via the telegraph model without feedback (e.g. the distribution of the Mbnl two gene as shown in Figure two a one and more genes as shown in Supplementary Figure S eight). In addition, we compared the inferred results between our hierarchical model and the telegraph model, finding that both models captured almost the same gene-expression variability (Coefficient of Variation squared, Figure two B) while keeping high correlations between burst frequencies and burst sizes (Figure two C, D, P-value less than two point two times ten to the negative sixteen). Notably, we found that the forms of dynamic feedback regulations can lead to different burst kinetics on a genome-wide scale but cannot be inferred by previous methods.


## Feedbacks modulate burst frequencies and sizes differently

Having inferred each gene's burst kinetics and feedback forms, we next investigated how feedback regulations affected expression variability and transcriptional burst kinetics on a genome-wide scale. Interestingly, we found the statistical phenomenon of Simpson's paradox. First, we observed from Figure three A that there were no significant differences in variability distributions between the positive-feedback and the negative-feedback genes, but the non-feedback genes exhibited higher expression variability. The latter result seemed inconsistent with the previous conclusions that positive feedback amplified variability and negative feedback attenuated variability. This can be interpreted by the fact that the expression level and the expression variability were negatively correlated (see Supplementary Figure S nine a). To show this point, we introduced the average expressed variable by dividing all the selected genes into five equal boxes based on average expression levels and tracked the expression-variability changes when the average gene-expression levels were increased. Then, we found that the expression variability was indeed negatively correlated with the average expression levels, regardless of feedback forms (see Figure three D). Furthermore, the positive- feedback genes showed relatively higher expression variability than the negative-feedback genes at the same expression levels, consistent with the results obtained in previous studies.

Next, we checked the genome-wide effects of feedback regulations on transcriptional burst frequencies and burst sizes. Interestingly, we found that positive and negative feedback differently modulated burst frequencies and sizes. Specifically, the burst frequencies of positive-feedback genes were significantly higher than those of negative-feedback genes on the whole genome and at the same expression level. By contrast, the burst sizes of positive-feedback genes were smaller than those of negative-feedback genes. In addition, the effects of negative feedback and non-feedback on burst frequencies were difficult to distinguish, but there was a significant difference in burst sizes. This observation suggested that burst size could be a distinguishable characteristic between negative-feedback and non-feedback genes.

Finally, in this subsection, we point out that an unexplored issue is how promoter architecture affects transcriptional burst kinetics in the presence of feedback regulation on a genome-wide scale. Below, we address this issue from three aspects: promoter motifs, transcription start site distributions, and enhancer-promoter interactions in the following.


## TATA genes are expressed with high burst frequencies only in the presence of positive feedback

It was reported that promoter motifs such as TATA box and initiator regulated transcriptional bursting directly. On the other hand, we showed in the previous section that different feedback regulations led to different burst kinetics. This raised an unexplored question: how do promoter motifs modulate transcriptional burst kinetics in the presence of feedback regulation on the genome-wide scale?

We first identified promoter motifs (TATA box, initiator, GC-box, and CCAAT-box) of each gene from the EPD database (see 'Materials and Methods'). Then, we found that both the TATA box and initiator positively regulated mean transcriptional levels, in line with the results obtained in previous studies. Besides, we verified that the TATA genes with positive feedback had higher proportions than those genes with negative feedback or without feedback, whereas the other promoter motifs were uncorrelated to feedback forms. These results implied that the TATA box was a critical promoter motif for the regulation of transcription by a positive feedback mechanism, which might be supported by the following experimental observation: TATA boxes were enriched in the promoters of genes with fewer transcriptional pauses, and the TATA box sequence was specifically bound by the TATA-binding proteins that acted as general transcription factors to facilitate the localization of RNA polymerase two and transcription.

To investigate the genome-wide effects of promoter motifs on burst kinetics in the presence of feedback regulations,

we performed multivariate statistical analysis using linear regression models (see 'Materials and Methods'). We also observed the Simpson's paradox that the effect of promoter motifs on variability and burst kinetics is different between distinguishing feedback regulation and without distinguishing feedback regulation.

First, we studied gene-expression variability. We characterized this variability with the residual squared coefficient of variation (see 'Materials and Methods') since this coefficient can disentangle the correlation of the coefficient of variation and the average expression levels across cells. Therefore, we focus on the residual squared coefficient of variation instead of the coefficient of variation. By performing the linear regression of the residual squared coefficient of variation (see 'Materials and Methods'), we found the synergy between positive feedback and the TATA box (or initiator or CCAAT box) can amplify the expression variability. This result was actually an extension of the previous result that the TATA box enlarged the gene-expression variability when feedback regulations were not distinguished. As an additional evaluation, we used the residual squared coefficient of variation rank to predict the presence of the TATA box and showed that the area under the receiver operating characteristic curve, denoted by AUC, was larger in the case of positive feedback than in the case of negative feedback or non-feedback, indicating that

TATA boxes led to the larger gene-expression variability in the former case.

Next, we assessed burst frequencies and sizes. Similar to the case of expression variability, we also performed multivariate linear regression analyses on them. When feedbacks were not distinguished, we showed that TATA boxes significantly boosted burst frequencies of the genes. However, when considering different feedback forms, we observed that only TATA genes with positive feedback increased burst frequencies. In addition, we observed that other promoter motifs had different degrees of effect on burst frequency, depending on feedback forms. These results were masked without distinguishing feedback forms. For burst sizes, it was reported that the genes with TATA box or initiator had larger burst sizes than those without TATA box or without initiator. We reproduced similar results, but observed that the TATA genes were expressed with larger burst sizes, independently of feedback regulation, and the genes with initiator had larger burst sizes only in the case of negative feedback. G C box and CCAAT box on the distal promoter had opposite effects on burst sizes in the cases of positive and negative feedback. In particular, no difference was found for all the genes if feedback forms were not distinguished.

Briefly, the above results indicated that the TATA box played a pivotal role in transcriptional bursting. It worked as a static promoter element to up-regulate burst sizes and simultaneously utilized a dynamic positive feedback regulation mechanism to increase burst frequencies.


## Feedback regulations concealed the effects of transcription start site distribution on transcriptional burst kinetics

TSS can be divided into two classes according to its distribution: single TSS (sharp promoter) and multiple TSSs (broad promoter), both being important for gene expression. It was reported that the shapes of TSS distribution correlated with the category of genes, such as housekeeping genes and cell-type-specific genes, both exhibiting different transcriptional burst patterns. On the other hand, some experimental results indicated that feedback can regulate transcriptional initiation. A question naturally arose: how do the shapes of TSS distribution affect transcription burst kinetics in the presence of feedback regulation?

To address this question, we used the R package CAGEr to read CAGE data of FANTOM five MEF cell and classified the promoters into 'broad' and 'sharp' ones according to the median, fifteen base pairs, of the widths of all sampled promoters as depicted in Figure five A. Similarly, the influence of the TSS distribution on variability and burst kinetics was subject to Simpson's paradox in the case of with and without distinguishing feedback regulations.

We showed that the impacts of different TSS distributions on the mean expression level did not exhibit apparent differences in three cases of feedback regulation and all genes. This property can avoid possible errors in evaluating the expression variability. Consistent with the observations in previous experimental studies, sharp promoters resulted in a significantly higher expression variability than broad promoters, independent of feedback forms. The expression variability declined with increasing the width, less than fifteen base pairs, of 'sharp' promoters but was almost unchanged with increasing the width of 'broad' promoters. Notably, the curve of rCV two versus promoter width for the positive-feedback genes was always above that for the genes with negative feedback or non-feedback.

Next, we investigated whether different TSS distributions affected burst frequencies and burst sizes differently. Although genes with 'sharp' promoters led to a higher expression variability than those with 'broad' promoters for arbitrary feedback forms, burst frequencies and sizes regulated by TSS distributions can exhibit significant discrepancy only in the absence of feedback. Broad promoters led to higher burst frequencies and smaller burst sizes than sharp promoters, in agreement with the experimental observation that broad promoters tended to occur in the case of low RNA polymerase two pause, whereas sharp promoters tended to occur in the case of high RNA polymerase two pause. These results implied that on the genome-wide scale, feedback regulations significantly weakened the impacts of TSS distributions on transcriptional burst kinetics.


## E-P interactions mainly modulate burst frequencies only in the presence of positive feedbacks

Enhancers, DNA sequences located upstream of the promoter, are important regulators of eukaryotic development. Several lines of experimental evidence supported that E-P interactions may facilitate gene transcription and can regulate transcriptional burst kinetics.

In addition, some studies showed that enhancer and promoter activations might require positive and negative feedback regulations, each contributing elements of the protein complement required for activation of other genes. These results raise important questions: does the genome-wide control of burst kinetics by E-P interactions involve feedback regulations? If so, how do feedbacks affect burst kinetics?

To address these questions, we first recovered the intensities of E-P interactions and performed LOESS regression. With the involvement of feedback regulations, the modulation of variability and transcriptional burst kinetics by E-P interactions also presents Simpson's paradox. We then showed that, for all genes, increasing the E-P intensities led to the rise of mean gene-expression levels but to the decline of variability, indicating that stronger enhancers raised the expression levels but lowered cell-to-cell variability in contrast to weaker enhancers. However, when distinguishing genes by feedback types, this pattern only appears in the case of positive feedback, implying the important role of positive feedback in E-P interactions.

Next, we focused on burst frequencies and sizes. Previous molecular experiments and genome-wide inferences from scRNA-seq data showed that burst frequencies and sizes increased with promoting E-P interactions, and that enhancers mainly controlled burst frequencies. The same conclusion was obtained when we performed analysis without distinguishing feedback types. Notably, when the feedback types was considered, we found that as the E-P intensity increased, changes in burst frequencies and sizes were most apparent in the case of positive feedback. Moreover, the slope of the line for the dependence of burst frequencies on E-P intensity was larger than that for the dependence of burst sizes on E-P intensity. In addition, we observed that this regulation effect of enhancers was saturated when the E-P interaction intensity exceeded a threshold of approximately forty. This result indicated that the function of the enhancer was not unlimited, in agreement with the theoretical prediction in our previous study.

The above genome-wide results provided direct support for the fact that the control of burst kinetics by E-P interactions was constrained by positive feedback regulations, in accordance with previous experimental results for a small number of genes.


## DISCUSSION

As the core process of life, gene transcription occurs stochastically, leading to variability in the M R N A and further protein abundances. This variability is believed to be mainly attributed to transcriptional bursting, a phenomenon that occurs commonly in both prokaryotes and eukaryotes. From the viewpoint of biophysics, the sources of transcriptional bursting are multilevel and multiscale. In this study, we have developed a statistical framework of the model-driven and data-driven integration to infer dynamic feedback regulations and transcriptional bursting kinetics from static scRNA-seq data, using a mechanistic mathematical model as the connecting thread.

The mechanistic model used in our inference framework was interpretable. It captured the scRNA-seq measurement process and the molecular mechanisms of transcriptional bursting processes. We showed that not only burst frequencies and sizes as well as expression variability but also feedback forms can be effectively and robustly inferred to explain biophysical phenomena, which were masked in the scRNA-seq data. Meanwhile, our inference method made the interpretable model tractable. We utilized the Gauss-Laguerre Quadrature Rules instead of the classical M C M C method to compute M R N A distribution with a high-order integral that is difficult to solve, thus making our scalable inference applicable on genome-wide scales. Our statistical inference framework laid a solid foundation for exploring the molecular mechanisms of stochastic gene expression based on single-cell data.

Our inference method provided a powerful tool for analyzing the joint effects of feedback regulation and promoter architecture and for revealing the genome-wide mechanisms of transcriptional burst kinetics. First, we found that at the same gene-expression levels, positive-feedback genes exhibited significantly higher gene-expression variability and higher burst frequencies as well as smaller burst sizes than negative-feedback genes on genome-wide scales. This finding indicated that different regulatory networks played distinct roles in modulating transcriptional burst kinetics. Second, we revealed that the TATA box, apart from being indicative of enlarging the expression variability and raising burst sizes as suggested in previous studies, can utilize a positive feedback mechanism to increase burst frequencies. This result may explain the phenomenon that the RNA polymerase two on the TATA box gene had better localization and fewer transcriptional pauses. Third, broad promoters with multiple TSSs led to higher burst frequencies and smaller burst sizes, which were concealed by the feedback regulations. Finally, we showed that enhancer-promoter interactions modulated burst kinetics and primarily controlled burst frequency in the presence of positive feedback. All these results were obtained under the hidden hypothesis that the intrinsic behaviors of the different gene were statistically identical. Overall, these genome-wide evidences indicated that transcriptional burst kinetics was not only encoded by static promoter architectures but also constrained by dynamic gene regulatory networks.

Our inference framework based on the model-driven and data-driven combination was an extensible one for studying the general principles of transcriptional bursting. First, gene expression variability caused by transcriptional bursts comes not only from technical noise and feedback regulation as described in our hierarchical model, but also from many other potentially complex mechanisms, such as RNA polymerase two recruitment and pause release ten to the power of two to ten to the power of five, alternative splicing, post-transcriptional regulations via mRNA degradation and nuclear retention, chromatin movement, etc., which all may affect burst kinetics. Second, promoter architecture can be described by a multi-state model since a transcription process would involve many molecular steps. It is unclear whether the multi-state architecture is more descriptive than the two-state model. Determining the number of gene states and studying the effect on burst kinetics is a long-term effort. Third, our hierarchical model only considered self-regulatory feedback, the simplest feedback form. More complex regulatory forms may exist in gene-expression systems. However, since they reflect high-level structure regulation, more complex yet reasonable mathematical models and more powerful inference methods need to be developed for better studying transcriptional burst kinetics. Fourth, most of the traditional models of gene expression were based on the Markov hypothesis. In organisms, however, the processes of molecular synthesis may be non-Markovian, and increasing time-resolved data have verified the extensive existence of molecular memory. Therefore, it is necessary to extend Markov models to non-Markov ones. But this is a great challenge to numerical solutions and statistical inferences. Finally, we point out that choosing a suitable model involves trade-off problems since more complex models would bring less consensus on general principles of transcriptional bursting.

Finally, studying transcriptional burst kinetics may start with a data-driven approach as done in our statistical inference framework. Our predictions of burst kinetics using scRNA-seq data were based on the assumption that the abundances of mRNA and protein were highly dependent. Recently, more and more studies of sequencing methods have paid attention to measuring the profiles of multi-type molecules in single-cell levels, such as simultaneous quantification of intracellular mRNA and protein, which can better describe cell states. For feedback loop types our method predicted, we found that many genes have been confirmed by biological experiments. Moreover, the identification of feedback loops can be more convincing by using multimodal data combined with scRNA-seq such as ENCODE and some automated packages. In addition, time-resolved data can provide more information compared to static data. We believe that with the continuous progress in measurement technologies, time-resolved single-cell data will be primary means to study the transcription burst kinetics in the future. Meanwhile, spatial transcriptome multimodal data and chromatin structural data provided good opportunities for in-depth studies of burst kinetics. Analysis of those multimodal single-cell data or integrated data can help us discover more credible biological knowledge but would also bring challenges for developing statistical methods to infer dynamic molecular mechanisms masked in static single-cell data.


## DATA AVAILABILITY

All the analysis results and inference code that support the findings of this study are provided through github dot com slash cellfate slash BurstFeedback or zenodo dot org slash record slash seven three seven one three one eight.


## SUPPLEMENTARY DATA

Supplementary Data are available at NAR Online.

Author contributions: J. Z. conceived of the study. S. L., Z. W. and J. Z. implemented the method, performed the analysis, and interpreted the results. Z. Z. helped with data analysis. J. Z. and T. Z. supervised the study. S. L., J. Z. and T. Z. drafted the manuscript with input from all the authors. All authors read and approved the final manuscript.


## FUNDING

National Key R and D Program of China twenty twenty-one YFA one three zero two five zero zero; Natural Science Foundation of P. R. China one two one seven one four nine four, one one nine three one zero one nine, one one seven seven five three one four; Guangdong Basic and Applied Basic Research Foundation twenty twenty-two A one five one five zero one one five four zero; Key-Area Research and Development Program of Guangzhou, P. R. China twenty nineteen B one one zero two three three zero zero two, twenty twenty zero zero seven zero three zero zero zero four; Guangdong Province Key Laboratory of Computational Science at the Sun Yat-sen University twenty twenty B one two one two zero six zero zero three two. Funding for open access charge: National Key R and D Program of China twenty twenty-one YFA one three zero two five zero zero; Natural Science Foundation of P. R. China one two one seven one four nine four, one one nine three one zero one nine, one one seven seven five three one four; Guangdong Basic and Applied Basic Research Foundation twenty twenty-two A one five one five zero one one five four zero; Key-Area Research and Development Program of Guangzhou, P. R. China twenty nineteen B one one zero two three three zero zero two, twenty twenty zero zero seven zero three zero zero zero four; Guangdong Province Key Laboratory of Computational Science at the Sun Yat-sen University twenty twenty B one two one two zero six zero zero three two.

Conflict of interest statement. None declared.