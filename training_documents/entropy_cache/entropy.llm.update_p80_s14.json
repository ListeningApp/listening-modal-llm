{
  "id": "chatcmpl-A3UGBqGTqN4cGkuqSdp2MKfh2bKcj",
  "choices": [
    {
      "finish_reason": "stop",
      "index": 0,
      "logprobs": null,
      "message": {
        "content": "````\n8dfo | Thus, in thermal equilibrium we can think of entropy as k times the log of the number of accessible states, \"corrected\" so that the result doesn't change when we add a constant to the energy of every state.\nlz3e | THE POWER OF THE PARTITION FUNCTION\ny26m | A classical harmonic oscillator with mass m and spring constant k has energy\nj0ou | p, q) = one half plus Kg squared divided by two m\nzk07 | Kg squared\n0lr7 | Its partition function is\nudsn | dp dq divided by h\n6tgb | Z of beta equals integral from zero to infinity e to the power of negative beta E of p, q\n7fxo | where beta is coolness and h is Planck's constant.\nnzpg | From this we can find its expected energy and free energy in thermal equilibrium:\nkou3 | F equals negative kT ln Z\nq8mn | expected energy equals negative ln Z d beta\n2n9u | and then its entropy:\nxtmy | S equals expected energy minus free energy divided by T where T is temperature, beta equals one divided by kT where k is Boltzmann's constant.\nmdfm | To test the power of the partition function, let's use it to figure out the entropy of a classical harmonic oscillator. Here's the game plan. First we'll compute the partition function by doing the integral in bright red. Then we'll use it to compute the oscillator's expected energy and free energy. Then we'll subtract those and divide by temperature to get the entropy.\nxjme | In fact, we've already worked out the answer to this problem:\nzb9k | S equals k ln beta h divided by T plus one.\n5yws | Our earlier approach led to some cool insights. But it was tricky, not systematic. The partition function method is systematic, so it's good for harder problems. It will also give new insight into that pesky plus one.\nt3fi | When we compute the entropy using a partition function, all the pain is concentrated at one point: computing the partition function! So let's get that over with.\ndyg0 | HARMONIC OSCILLATOR: PARTITION FUNCTION\n3n0b | A classical harmonic oscillator has energy E of p, q equals p squared divided by two m plus K squared q squared divided by two and frequency omega equals square root of K divided by m, so its partition function is\n46bq | square root of two pi m divided by beta to the power of one half\ntocx | integral from zero to infinity e to the power of negative beta r squared divided by two r d r d theta\n07f7 | switching to polar\n3cv9 | u equals r squared divided by two\nxa2i | equals one divided by beta h omega\nxj8o | how beta\ngk3j | Z of beta equals\n8vzd | beta h omega\n6588 | For the harmonic oscillator, the partition function is the integral of a Gaussian in two variables. A change of variables makes the Gaussian round, and then we use polar coordinates to do the integral.\n1ms8 | The physicist Kelvin is said to have written\nb1vx | integral from negative infinity to infinity e to the power of negative x squared dx equals square root of pi\n4i6r | on the blackboard and said \"A mathematician is one to whom that is as obvious as that twice two makes four is to you.\" I find that rather obnoxious, but when I heard the story as a kid, I made damn sure I knew how to do this integral. The usual trick is to compute the square of this integral using polar coordinates.\na3i4 | Now we're seeing something interesting. The harmonic oscillator, whose energy depends quadratically on two degrees of freedom, is physically more important than a system whose energy depends quadratically on just one degree of freedom. And when beta equals h equals omega equals one, the partition function of the harmonic oscillator is\nheua | integral from zero to infinity e to the power of negative r squared divided by two r d r d theta equals integral zero to infinity e to the power of negative u d u equals one half pi\ng2u7 | which is more fundamental than the integral Kelvin wrote down.\n5l9k | HARMONIC OSCILLATOR: EXPECTED ENERGY\n5zaz | A classical harmonic oscillator has partition function\npc7u | Z equals beta h omega\n5554 | so its expected energy in thermal equilibrium is\nbijr | expected energy equals negative two divided by partition function equals derivative of ln Z with respect to beta\ni2gp | expected energy equals kT\nxq5u | just as the equipartition theorem says it must be!\nkbyk | Once we know the partition function of the classical harmonic oscillator, it's easy to compute its expected energy: just use\nuulj | expected energy equals derivative with respect to beta of ln Z\ne3k9 | and get\n5biw | expected energy equals kT\nn108 | beta equals one\nnyac | We can also figure this out using the equipartition theorem. Remember, the equipartition theorem applies to a classical system whose energy is quadratic. If it has n degrees of freedom, then at temperature T it has\n2cn1 | expected energy equals n divided by two kT.\nc3m1 | Our harmonic oscillator has n equals two, so we get expected energy equals kT. Good, this matches the partition function approach!\n9yo6 | HARMONIC OSCILLATOR: FREE ENERGY\nkiqm | A classical harmonic oscillator has partition function\n6n7u | Z of beta equals\ncodw | so its free energy in thermal equilibrium is\nsuvf | F equals negative kT ln Z equals negative kT ln beta h omega\npsc6 | F equals negative kT ln\nm69t | how\nylr1 | The partition function lets us do more! It lets us compute the free energy, too, using\n7xmx | F equals kT ln Z\nspty | Unlike the expected energy, the free energy involves Planck's constant:\nfosi | F equals negative kT ln\ntsuw | Note kT and h omega both have units of energy, so kT divided by h omega is dimensionless, which is good because we're taking its logarithm. Also note that the free energy is negative at high temperatures! That may seem weird, but it turns out to be good when we compute the entropy.\nl0hr | HARMONIC OSCILLATOR: ENTROPY\n5jk8 | In thermal equilibrium at temperature T, a classical harmonic oscillator has\n4cms | kT divided by h omega so its entropy is\niynx | expected energy equals kT and free energy F equals negative kT ln\nub6m | kT divided by h omega\na67b | negative\n8ibh | kT plus kT ln T\nelv7 | S equals expected energy minus F divided by T\noazo | kT\nl85h | plus one\nhe3v | divided by h omega\ny1kq | To compute the entropy of a classical harmonic oscillator, we just use\nclin | S equals expected energy minus F divided by T.\nhiag | We get the answer we got before, of course:\nwfg5 | S equals k ln beta h divided by T plus one.\nf5sm | But now we can finally understand the puzzling extra plus one.\nyw9n | As we've seen, the entropy of any system in thermal equilibrium consists of two parts:\n8u3s | One. The free energy part, negative F divided by T. For the classical harmonic oscillator this is\nhmg7 | Two. The expected energy part, expected energy divided by T. For the classical harmonic oscillator this is\np0a7 | expected energy divided by T\nochb | k.\npcum | The free energy part of the entropy is always k times the logarithm of the number of accessible states. For the classical harmonic oscillator, the expected energy part of the entropy must equal k by the equipartition theorem, since the oscillator's energy depends on two degrees of freedom. This is small compared to the free energy part when h omega is much less than kT: that is, when quantum effects are small compared to thermal effects.\nbu0s | PARTICLE IN A BOX: PARTITION FUNCTION\njr8i | The energy of a classical free particle of mass m in a one-dimensional box depends only on its momentum p:\n7mby | E equals p squared divided by two m\na1ha | Its position q is trapped in the interval [zero, L].\ngkfg | Its partition function is therefore\nv9o7 | Z of beta equals integral from zero to L integral from negative infinity to infinity e to the power of negative beta E of p, q dp dq divided by h\ngq1l | h integral from zero to L integral from negative infinity to infinity e to the power of negative beta p squared divided by two m dp equals\n90in | square root of two pi m\n8zn4 | divided by beta\nexk3 | Now let's turn to our ultimate goal: computing the entropy of a box of gas. As a warmup, let's figure out the entropy of a single particle in a box. In fact, let's start with a a free classical particle in a one-dimensional box: that is, in some interval [zero, L].\ntx5q | The first step is to compute its partition function. As you can see, this is easy enough. But the whole idea raises some questions. Some people get freaked out by the concept of entropy for a single particle I guess because it involves probability theory for a single particle, and they think probability only applies to large numbers of things.\nly5j | I sometimes ask these people \"how large counts as large?\" In fact the foundations of probability theory are just as mysterious for large numbers of things as for just one thing. What do probabilities really mean? We could argue about this all day: Bayesian versus. frequentist interpretations of probability, etc. I said a tiny bit about this before, and I won't say more now.\nh2rq | Large numbers of things tend to make large deviations less likely. For example the chance of having all the gas atoms in a box all on the left side is less if you have one thousand atoms than if you have just two. This makes us worry less about using averages and probability.\n```",
        "role": "assistant",
        "function_call": null,
        "tool_calls": null,
        "refusal": null
      }
    }
  ],
  "created": 1725394667,
  "model": "gpt-4o-2024-05-13",
  "object": "chat.completion",
  "system_fingerprint": "fp_fde2829a40",
  "usage": {
    "completion_tokens": 2196,
    "prompt_tokens": 3764,
    "total_tokens": 5960
  }
}