{
  "id": "chatcmpl-A3U8cjohPnYR9fVfMEeScISQdT0nh",
  "choices": [
    {
      "finish_reason": "stop",
      "index": 0,
      "logprobs": null,
      "message": {
        "content": "```29a3 | For every fixed read count value at a particular allele, we approximated the distribution of read counts mapped to the other allele as a mixture of two Negative Binomial distributions. The model estimates the number of successes X (the number of reads mapped to the selected allele) given the number of failures R (the number of reads mapped to the second allele) in the series of Bernoulli trials with probability of success P (for the first distribution in the mixture) or one minus P (for the second distribution in the mixture). The following holds for scoring Ref-ASBs at\nsb1e | fixed Alt-allele read counts:\nw2yn | C sub Alt is distributed as open parenthesis one minus W close parenthesis times Negative Binomial open parenthesis R, P close parenthesis plus W times Negative Binomial open parenthesis R, one minus P close parenthesis fixed\nap6l | P(CRef equals X given fixed CAlt equals M, CRef greater than or equal to five)\niest | equals open parenthesis X plus R minus one close parenthesis choose X open parenthesis open parenthesis one minus W close parenthesis times open parenthesis one minus P close parenthesis to the power of R times P to the power of X plus W times open parenthesis one minus P close parenthesis to the power of X times P to the power of R close parenthesis divided by A A equals one minus P open parenthesis C sub Ref less than five given fixed C sub Alt equals M close parenthesis one\ncox8 | where P and one minus P were fixed to reflect the expected frequencies of allelic reads, namely, one divided by open parenthesis BAD plus one close parenthesis and BAD divided by open parenthesis BAD plus one close parenthesis. The parameters R (number of failures) and W (weights of distributions in the mixture) were fitted with L-BFGS-B algorithm from scipy.optimize package to maximize the model likelihood iteratively with boundaries R greater than zero and zero less than or equal to W less than or equal to one, assigning initial values of R equals M (number of reads on the fixed allele) and W equals zero point five, respectively. A is the normalization coefficient (necessary due to truncation) corresponding to allelic reads cutoff of five. The goodness of fit was assessed by root mean square error of\nppqi | approximation (RMSEA, Supplementary Figure eleven). Low-quality fits with RMSEA greater than zero point zero five were discarded, fixing the parameters at R equals M and W equals one, thereby penalizing the statistical significance of ASB at such SNVs, as fitted R is systematically lower than M (Supplementary Figure twelve). Of note, the values of R for distribution of reference allele read counts (with fixed alt-allele read counts) were systematically higher than those for alternative allele read counts (with fixed Ref-allele read counts), thus balancing the reference mapping bias. The obtained fitted models were used for statistical evaluation of ASB for alternative and reference alleles\noxou | independently, with one-tailed tests. Examples of fits for BAD equals in Figure six E, F, with RMSEA less than zero point zero two for the fixed Ref/Alt read counts of ten. Aggregation of ASS P values from individual datasets. For external validation we performed the ASB calling. Next, the SNVs were grouped by a particular TF across cell types or by a particular TF. A group of SNVs with the same position and alternative alleles was considered as an ASB candidate if at least one of the SNVs passed a total coverage threshold greater than or equal to twenty. Next, for each ASB candidate, we performed logit aggregation of individual ASB P values, independently for Ref-ASB and Alt-ASB. Individual P were excluded from aggregation, and if none were left, the aggregated P\n495n | Logit aggregation is the method of choice, as it has two advantages. First, P values can arise both from a small number of strongly imbalanced SNVs in deeply\nawri | sequenced data sets and from a large number of sets with low or medium coverage. Compared to the similar Stauffer's method, the logit aggregation is less sensitive to the extreme P values and can be considered a robust choice. The Benjamini-Hochberg adjustment for multiple tested SNVs separately for each TF and each cell type. SNVs passing zero point zero five FDR for either Ref or Alt-allele were considered ASB.\nawri | ASB effect size estimation. We define the ES separately for reference allele ASB open parenthesis ESR close parenthesis and alternative allele ASB open parenthesis ESA close parenthesis as the log ratio of the observed number of reads to the expected number. To account for BAD and mapping bias, we use fitted Negative Binomial mixture at the fixed allele read counts:\n```",
        "role": "assistant",
        "function_call": null,
        "tool_calls": null,
        "refusal": null
      }
    }
  ],
  "created": 1725394198,
  "model": "gpt-4o-2024-05-13",
  "object": "chat.completion",
  "system_fingerprint": "fp_fde2829a40",
  "usage": {
    "completion_tokens": 998,
    "prompt_tokens": 3312,
    "total_tokens": 4310
  }
}