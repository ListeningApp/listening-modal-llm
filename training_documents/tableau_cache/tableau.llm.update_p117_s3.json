{
  "id": "chatcmpl-A3UEG9eiv2soe2O5fuZuIjwIgF8AS",
  "choices": [
    {
      "finish_reason": "stop",
      "index": 0,
      "logprobs": null,
      "message": {
        "content": "sqoe | AND, OR, and NOT: These link or negate conditions that need to be met.\nok42 | END: This is critically important, as it terminates the loops of the IF and CASE statements. Tableau Public will tell you in case you need to add it and have not done so.\na22o | The IF statements are very useful. You can use them to group members and set thresholds, among many other uses. The condition that needs to be met can be a variety of things. In the first example, we will create a new measure in a transformation of the World Bank indicator data that we have extracted and transformed, and it's called population and land data.\ntxc2 | We will create a new measure that gives us the total land area of a country. We want to use this measure to determine the percentage of each country's area that was flooded, but this measure does not exist in the Floods data, but it does exist in the Population and Land Data. Later in this chapter, we will blend the data sources to create a calculated field that uses it in the denominator.\n65aq | The Population and Land Data does not have a metric called total area. The way the data source is structured, the measures are in rows and not columns, with a field representing the corresponding metric value, as shown in the following screenshot. We need to create a calculated field that states that if Indicator Name is Land area (sq. km), then we want the Indicator Value to appear as follows:\ni3ag | Chapter five\nt1vi | In order to do this, we will follow these steps:\nhkxq | One. Create a new calculated field in the Population and Land Data source by clicking on the Context menu in the Data window and selecting Create Calculated Field.\n9gst | Two. Name the calculated field Area of Country.\n094q | Three. Start an IF statement that says that if the Indicator Name is Land area (sq. km), then Tableau Public should use Indicator Value. Otherwise, it should use zero.\nnlyd | Four. End the statement.\nk5jo | Five. Validate that there are no error messages.\nr3vp | Six. Click on OK. The result is shown in the following screenshot:\nnuc1 | In this statement, if we did not include the ELSE statement, then the products of the field would be null for every value of Indicator Value that isn't specified, and we do not want nulls, because performing any kind of mathematical operation on a null value results in a null value even when you're adding or multiplying it by valid numbers. So, we included else zero, even though we did not necessarily need to do so, in order to preserve the integrity of the data set.\n2vej | Another good use of an IF statement is to create groups or establish performance thresholds. In the World Bank Indicators data source, there is a field that identifies the percentage of its GDP that each country spends on public health. The first quartile is at five percent, the median is at seven percent, and the upper quartile is at nine percent. In the following example, we will use mathematical functions to group the countries according to what their average expenditure on public health is.\nzj7x | In this example, we have hard-coded the values in the inequalities, which means that the thresholds used for the groups are not dynamic. In the next chapter, we will use window calculations to make them dynamic.\n5dcq | We created a simple box plot that shows the maximum health expenditure as a percentage of the GDP per country in two thousand ten. Since we put Country on the Detail shelf, Tableau Public graphs one mark per country. In the calculated field, we even accounted for null values, as represented in the ELSE statement. Then, we put this new calculated field on the Color shelf of the box plot, as shown in the following screenshot:\n1hqm | Perform the following steps to create this graph:\n2r71 | One. Add Health: Health expenditure, total (percent GDP) to the Columns shelf.\najz6 | Two. From the Analysis menu, deselect Aggregate Measures.\nbsoa | Three. Drag Date to the Filters shelf and select YEAR.\nmmo2 | Four. Filter YEAR to two thousand ten.\nj69r | Five. Drag Military: Expenditures (percent GDP) to the Size shelf.\n2ugw | Six. Drag Country to the Detail shelf on the Marks card.\na6jg | Seven. Create a new calculated field called Health Expenditure Quartile, and provide Tableau Public with several conditions to test.\n91u8 | Chapter five\n51g2 | We wrote the conditions in a specific order so that for each country, the accurate value is the output.\nekj5 | Eight. Drag the new field named Health Expenditure Quartile to the Color shelf.\n0heu | Nine. Adjust the colors so that the lower quartiles are in red and the upper quartiles are in blue.\nyh7j | This IF statement is similar to the two other types of logic statements in Tableau Public, namely IIF and CASE.\n3ql4 | The structure of IIF is the same as that of the IF statements in Excel, and it's very similar to the IF statement that we just created in that you are asking Tableau Public to test a condition and then provide the results according to the logical outcome, which can be either true or false. In the following example, we will ask Tableau Public whether the last letter of the name of each country is A.\n9rtl | There are two possible outcomes - yes, the condition is met, and no, it is not met. We tell Tableau Public what value to use for each possible outcome. We can use a string, a number, another field or aggregation, or even nothing at all.\nwjx6 | In the following example, which is for demonstration purposes, we ask Tableau Public to test whether each country name in the global major floods data, which was trimmed in the section on string functions, ends with the letter A. If the condition is met, the result should be blank (which is different from NULL), but in case it is not met, then the outcome should be the last letter of the country:\nt62c | Blending data sources\n50qr | If you want to create a calculated field that produces the percentage of the total land flooded during an event, we need to use a data source that has this information in it. Most stories need more than one data source. When you are adding in secondary data sources, it's important to know what the level of aggregation is if you have joined data sources with different levels of aggregation and have not accounted for that when blending them because if you fail to do so, you might get the wrong results in your calculated fields.\n2mku | The flood data is aggregated at the event level. This means that for every major flood, we have summarized data - the start date, end date, location, total land area affected, and so on. This is moderately granular data. If it were even more summarized, it might be summed up as floods per year per country.\napbe | We want to know the total percent of land flooded each year, and for this, we will assume that the area of each country is static throughout time. So, we created a new data source. We filtered the World Bank indicators data in this data source to include only the indicators pertaining to the land area or population. The World Bank indicator data is aggregated by country by year, which is not the same level of aggregation as that of the data on floods; it is higher. So, in our calculated field, which will sum the total area flooded and then divide it by the total area of each country, we will need to tell Tableau how to aggregate the total area of each country. Otherwise, we will get the wrong results.\n2wh5 | First, we need to join the data sources. In the companion workbook, which can be found at, we have a data source called Population and Land Data. This is the version of the World Bank indicators that we have filtered. It has only four dimensions, in this case, we have three, Country, Indicator Name, and Year. The data source on floods has Country Name and several other date fields. We want to join on Country name, as shown in the following screenshot:\ntjrm | Chapter five",
        "role": "assistant",
        "function_call": null,
        "tool_calls": null,
        "refusal": null
      }
    }
  ],
  "created": 1725394548,
  "model": "gpt-4o-2024-05-13",
  "object": "chat.completion",
  "system_fingerprint": "fp_fde2829a40",
  "usage": {
    "completion_tokens": 1711,
    "prompt_tokens": 3449,
    "total_tokens": 5160
  }
}