{
  "id": "chatcmpl-A3UB6EJLZ0qSURl8L5u1OLubjJv5v",
  "choices": [
    {
      "finish_reason": "stop",
      "index": 0,
      "logprobs": null,
      "message": {
        "content": "df3e | The first level represents the measurement process for the observed count Yeg conditional on the true expression level Neg of gene g in cell c, with a conditional probability distribution:\n53eu | Ycg given Neg follows Pmeas of y given n.\na5u1 | The Pmeas of y given n describes all aspects of the technical noise produced in the measurement process for a given true expression level Neg, and is suggested as a Binomial distribution or Poisson distribution which is supported by empirical analyses and theoretical arguments in many existing methods. By adding an extra sampling probability Àcg in the sequencing process, we characterize the sequencing depth and assume that intercellular molecules are independent of each other and only the proportional products are captured and sequenced using Binomial distribution\nry7u | Ycg given Neg follows Binomial of n, Àcg.\n5mda | In our calculations, we set the sampling probability Àcg equals zero point five without loss of generality since the setting of Àcg does not influence our qualitative results.\ni4li | The second level is the true expression level of gene g across cells, which is assumed to follow a probability distribution\nr8sm | Neg follows Pgene of n.\ncuin | The underlying model describes the intrinsic dynamics of stochastic gene expression. How an appropriate gene-expression model Pgene of n is chosen is critical. In general, this choice needs to satisfy two basic requirements: (i) the model should capture the essential gene-expression dynamics of interest (e.g. transcriptional burst kinetics); and (ii) the inference based on the model should be effective and scalable to large numbers of cells and genes. As combining mechanistic models to infer the entire gene regulatory\nn1i7 | network would lead to sophisticated models that become intractable, we simplified the gene regulatory network to a feedback loop, which is the most common form existing in gene expression systems. For these purposes, we adopt a model of stochastic gene expression, which simultaneously characterizes transcriptional burst kinetics and auto-regulatory feedbacks with the below distribution\n0r5m | Pgene of n equals N N\nne2o | zero to infinity Poisson of n given x x raised to the power of a times one plus e minus one e to the power of negative x over b one plus the fraction of x over k closes the bracket raised to the power of a all over dx,\nsqxn | where N is a normalization factor. Note that the discrete gene expression distribution is a Poisson representation in form, i.e. Pgene of n equals Poisson of n given x f of x dx, where f of x is a kernel density function that has the same form as the continuous distribution of proteins. As illustrated in Figure one B, this kernel function f of x can extract several kinetic parameters, denoted by θ equals a, b, c, k, h, of the steady-state gene-product distribution from a dynamic model with auto-regulatory feedback described by some meaningful kinetic parameters: switching rates between inactive and active state kon, koff, mRNA transcription rates Ksyn and degradation rates kdeg. Here, a is the number of bursts per cell cycle (burst frequency), and b is the mean number of gene products generated per burst (burst size), and h is a vital parameter of capturing the feedback regulation dynamics of gene products, which is actually a Hill coefficient. Furthermore, this model can describe two most common feedback loops in gene expression: positive-feedback loop (i.e. h less than zero) and negative feedback loop (i.e. h greater than zero). It should be noted that the auto-regulatory feedbacks involve gene products, which directly or indirectly regulate the corresponding target gene itself through feedback loops, resulting in a repressing or activating expression. The small leakiness proportion of the promoter contains the information on the baseline bursts in the absence of regulation, and k contains the information on the equilibrium binding constant. Overall, Equation is a mechanistic model, which can simultaneously describe the burst-production and feedback-regulation processes of gene expression. More importantly, as a special case of this model, h equals zero corresponds to the negative binomial distribution of gene expression Pgene of n (i.e. non-feedback).\n6pmo | By combining Equations and and substituting into Equation, the discrete probability distribution of Yeg can be computed but is expressed in an integral form:\n195r | P of Y equals y equals integral from zero to infinity of Pmeas of y given n Pgene of n dn\nkqmi | equals integral from zero to infinity Poisson of Y equals y given x f of x dx\ng8rd | equals N integral from zero to infinity\nnns9 | x raised to the power of a times one plus e minus one e to the power of negative x over b one plus the fraction of x over k closes the bracket raised to the power of a all over y factorial dx.\n9uwy | For the case of non-feedback, we employ the negative binomial distribution, which is then given by\nsrly | equals y equals the integral of a raised to the power of v times e raised to the power of negative x times the fraction of one over x all raised to the power of y, a divided by the quantity a minus one factorial, times x raised to the power of a minus one e to the power of negative x over b dx, where Gamma is the Gamma function.\ndl6i | Maximum likelihood estimation of parameters\n89ub | Here we introduce a method of estimating the kinetic parameters in our hierarchical model using the expression data of each gene. For a given expression read of observed cells, the most common parameter estimation method is the maximum likelihood estimation, which can be formulated as the following optimization problem of five parameters θ equals a, b, c, k, h in our case\ndhle | arg min of negative L of y given θ equals arg min of theta negative ln of P of Y equals y given theta,\n2nib | Because of the complex integral and unnormalized probability mass function in Equation, calculating the integral directly through the M C M C method would be at a high cost of computation, and in particular, it is hard to use in the analysis of genome-wide data. Therefore, we apply the Generalized Gauss-Laguerre Quadrature Rules to Equation instead of the use of the M C M C method, realizing a rapid calculation in inference:\nnaev | P of Y equals y given θ equals N the fraction of x raised to the power of a times one plus e minus one e to the power of negative x over b one plus the fraction of x over k dx zero to infinity\n7h0h | where xi, wi can be determined by the generalized Laguerre polynomials.",
        "role": "assistant",
        "function_call": null,
        "tool_calls": null,
        "refusal": null
      }
    }
  ],
  "created": 1725394352,
  "model": "gpt-4o-2024-05-13",
  "object": "chat.completion",
  "system_fingerprint": "fp_fde2829a40",
  "usage": {
    "completion_tokens": 1381,
    "prompt_tokens": 3193,
    "total_tokens": 4574
  }
}